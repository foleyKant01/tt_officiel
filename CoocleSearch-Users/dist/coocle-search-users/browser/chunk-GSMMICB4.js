import{a as ve,b as j}from"./chunk-4HFKDTOB.js";import{a as re,b as ae,c as le,d as ce,e as de,f as me,g as ue,h as pe,i as fe,l as M,m as ge}from"./chunk-JKM56Z2F.js";import{A as x,E as f,G as d,H as $,I as n,J as s,K as l,L as G,M as W,N as h,O as p,P as u,Q as L,S as K,T as r,U as E,V as k,X as y,Y as H,Z as I,_ as Q,a as S,b as w,fa as B,ga as N,ha as V,ia as C,ja as ie,k as Z,l as P,ma as ne,n as ee,na as oe,o as b,oa as R,p as F,pa as se,ra as _,s as g,t as v,x as T,y as te,z as c}from"./chunk-NDQ5UUJF.js";var O=class o{constructor(i){this.http=i}api_url=ge.apiUrl;ReadAllFavorisByUser(i){return this.http.post(this.api_url+"/api/favoris/read_all_favoris_by_user",i)}SaveFavoris(i){return this.http.post(this.api_url+"/api/favoris/save_favoris",i)}DeleteFavoris(i){return this.http.post(this.api_url+"/api/favoris/delete_favoris",i)}ReadAllHistoriqueByUser(i){return this.http.post(this.api_url+"/api/historiques/read_all_historique_by_user",i)}DeleteHistoriques(i){return this.http.post(this.api_url+"/api/historiques/delete_historiques",i)}static \u0275fac=function(e){return new(e||o)(ee(ie))};static \u0275prov=Z({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ce=()=>["/auth/login/"],Se=()=>["/profil"],we=()=>["/user/activites"],Ee=o=>({"tablet-fullwidth":o}),ke=o=>({active:o});function Me(o,i){o&1&&(n(0,"a",44),r(1," Connexion "),s()),o&2&&d("routerLink",H(1,Ce))}function Oe(o,i){if(o&1){let e=h();n(0,"button",45),p("click",function(){g(e);let a=u();return v(a.toggleProfileMenu())}),l(1,"i",46),s()}}function Ae(o,i){if(o&1){let e=h();n(0,"div",47)(1,"a",48),l(2,"i",49),r(3," Profil "),s(),n(4,"a",48),l(5,"i",50),r(6," Activit\xE9s "),s(),n(7,"a",51),p("click",function(){g(e);let a=u();return v(a.logout())}),l(8,"i",52),r(9," D\xE9connexion "),s()()}o&2&&(c(),d("routerLink",H(2,Se)),c(3),d("routerLink",H(3,we)))}function Ie(o,i){o&1&&(n(0,"div",53),l(1,"div",54),s())}function Pe(o,i){o&1&&(n(0,"div",55)(1,"h4",56),r(2,"Aucun r\xE9sultat trouv\xE9."),s()())}function Fe(o,i){if(o&1){let e=h();n(0,"div",59)(1,"div",60)(2,"button",61),p("click",function(){let a=g(e).$implicit,m=u(2);return v(m.toggleFavorite(a))}),l(3,"i",62),s(),n(4,"div",26)(5,"div",63),l(6,"img",64),s(),n(7,"div",65)(8,"div",66)(9,"h5",67),r(10),s(),n(11,"p",68),r(12),s(),n(13,"p",69),l(14,"i",70),r(15),s(),n(16,"p",69),l(17,"i",71),r(18),s(),n(19,"div",72)(20,"button",73),p("click",function(){let a=g(e).$implicit,m=u(2);return v(m.readSingleBusiness(a.bu_uid))}),l(21,"i",74),r(22," Voir "),s()()()()()()()}if(o&2){let e=i.$implicit,t=u(2);d("ngClass",I(9,Ee,t.All_business.length===1)),c(2),d("ngClass",I(11,ke,t.isFavorite(e))),c(),d("ngClass",t.isFavorite(e)?"fa-heart":"fa-heart-broken"),c(3),L("alt",e.bu_name),d("src",e.bu_picture||"assets/img/default.jpg",T),c(4),E(e.bu_name),c(2),E(e.bu_description),c(3),k(" ",e.bu_city,""),c(3),k(" ",e.bu_address,"")}}function Te(o,i){if(o&1&&(n(0,"div",57),f(1,Fe,23,13,"div",58),s()),o&2){let e=u();c(),d("ngForOf",e.All_business.slice(0,e.visibleCount))}}function Le(o,i){if(o&1){let e=h();n(0,"div",75)(1,"button",76),p("click",function(){g(e);let a=u();return v(a.showAll())}),r(2,"Voir plus"),s()()}}function He(o,i){if(o&1){let e=h();n(0,"button",77),p("click",function(){g(e);let a=u();return v(a.scrollToTop())}),r(1,` Go back up \u2191
`),s()}}var D=class o{constructor(i,e,t,a){this.router=i;this.http=e;this.route=t;this.api=a}data;textSearch;search_form=new de({textSearch:new me(null,ae.required)});All_business=[];searchDone=!1;backToTopBtnVisible=!1;isLoggedIn=!1;dataBusiness;user_infos;user_id;localisation;coordonne;loading=!1;favoriteList=[];Searchbusiness(){this.loading=!0;let i=this.search_form.get("textSearch")?.value.trim();if(!i)return;let e={textSearch:i,user_id:this.user_id,latitude:this.coordonne.latitude,longitude:this.coordonne.longitude};this.http.SearchBusinessByCategorie(e).subscribe({next:t=>{console.log("Response:",t),t?.status==="success"&&Array.isArray(t.business)?(setTimeout(()=>{this.loading=!1,this.All_business=t.business,this.searchDone=!0},2e3),t.business&&(sessionStorage.setItem("All_business",JSON.stringify(t.business)),sessionStorage.setItem("businessList",JSON.stringify(t.business)),sessionStorage.setItem("textSearch",JSON.stringify(t.textSearch)))):(this.All_business=[],sessionStorage.setItem("All_business",JSON.stringify(this.All_business)),sessionStorage.setItem("textSearch",JSON.stringify(t.textSearch)),this.loading=!1,this.searchDone=!0)},error:t=>{console.error("Erreur lors de la recherche :",t),this.searchDone=!0,this.All_business=[],t.error instanceof ProgressEvent?console.log("Erreur li\xE9e \xE0 un mauvais format JSON ou content-type."):console.log("R\xE9ponse du serveur :",t.error)}}),this.createStats()}createStats(){let i=this.search_form.get("textSearch")?.value.trim();if(!i)return;let e={textSearch:i,all_business_found:this.All_business,city:this.localisation.city,commune:this.localisation.commune,longitude:this.coordonne.longitude,latitude:this.coordonne.latitude};this.http.CreateStats(e).subscribe({next:t=>{t?.status==="success"&&console.log("message: ",t.message)},error:t=>{console.error("Failed to load products:",t)}})}logout(){sessionStorage.removeItem("access_token"),sessionStorage.removeItem("businessList"),sessionStorage.removeItem("user_infos"),this.router.navigate(["/auth/login"])}navigateToHome(){window.location.href="/user/home"}readSingleBusiness(i){this.router.navigate(["/user/business/readsingle-business",i])}visibleCount=6;get visibleBusinessList(){return this.All_business.slice(0,this.visibleCount)}showAll(){this.visibleCount=this.All_business.length}onScroll(){let i=document.documentElement.scrollTop||document.body.scrollTop;this.backToTopBtnVisible=i>200}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}profileMenuVisible=!1;toggleProfileMenu(){this.profileMenuVisible=!this.profileMenuVisible}unloadCallback=()=>{sessionStorage.removeItem("All_business"),sessionStorage.removeItem("single_business"),sessionStorage.removeItem("textSearch")};isFavorite(i){return i.is_favs===1}toggleFavorite(i){this.favoriteList=this.All_business.filter(t=>t.is_favs===1);let e=this.All_business.findIndex(t=>t.bu_uid===i.bu_uid);e>-1&&(this.All_business[e].is_favs=this.All_business[e].is_favs===1?0:1,this.favoriteList=this.All_business.filter(t=>t.is_favs===1),sessionStorage.setItem("All_business",JSON.stringify(this.All_business)),this.All_business[e].is_favs===1?this.saveFavoris(this.All_business[e]):this.deleteFavoris(this.All_business[e]))}saveFavoris(i){let e=w(S({},i),{user_id:this.user_id});console.log("payload:",e),this.api.SaveFavoris(e).subscribe({next:t=>{console.log("Response:",t.status)},error:t=>{console.error("Erreur lors de la recherche :",t),this.favoriteList=[]}})}deleteFavoris(i){let e=w(S({},i),{user_id:this.user_id});console.log("payload:",e),this.api.DeleteFavoris(e).subscribe({next:t=>{console.log("Response:",t)},error:t=>{console.error("Erreur lors de la recherche :",t),this.favoriteList=[]}})}ngOnInit(){let i=sessionStorage.getItem("user_infos");if(this.isLoggedIn=!!i,this.user_infos=i,console.log(this.user_infos),i){this.user_infos=JSON.parse(i),this.user_id=this.user_infos.u_uid,console.log("user_id:",this.user_id),this.route.queryParams.subscribe(xe=>{let Y=xe.data;console.log("data:",this.data),Y&&(this.All_business=JSON.parse(Y),console.log(this.All_business))});let e=JSON.parse(sessionStorage.getItem("All_business")||"null"),t=JSON.parse(sessionStorage.getItem("textSearch")||"null"),a=JSON.parse(sessionStorage.getItem("localisation")||"null"),m=JSON.parse(sessionStorage.getItem("coordonne")||"null");e?(console.log("Business infos trouv\xE9 en session:",e),this.All_business=e):console.warn("Aucun Business trouv\xE9 dans sessionStorage"),t?(console.log("textSearch infos trouv\xE9 en session:",t),this.textSearch=t):console.warn("Aucun Business trouv\xE9 dans sessionStorage"),a?(console.log("localisation infos trouv\xE9 en session:",a),this.localisation=a):console.warn("Aucun localisation trouv\xE9 dans sessionStorage"),m?(console.log("coordonne infos trouv\xE9 en session:",m),this.coordonne=m):console.warn("Aucun coordonne trouv\xE9 dans sessionStorage"),window.addEventListener("beforeunload",this.unloadCallback)}this.getCurrentLocationAndAddress()}getCurrentLocationAndAddress(){navigator.geolocation?navigator.geolocation.getCurrentPosition(i=>{let e=i.coords.latitude,t=i.coords.longitude;console.log("Latitude:",e,"Longitude:",t),this.getCityAndCommuneFromCoords(e,t).then(a=>{sessionStorage.setItem("localisation",JSON.stringify(a)),sessionStorage.setItem("coordonne",JSON.stringify(i.coords))})},i=>{console.error("Erreur de g\xE9olocalisation :",i.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):console.error("La g\xE9olocalisation n\u2019est pas prise en charge par ce navigateur.")}getCityAndCommuneFromCoords(i,e){let t=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${i}&lon=${e}&zoom=18&addressdetails=1`;return fetch(t,{headers:{"User-Agent":"CoocleSearch/1.0 (your@email.com)"}}).then(a=>a.json()).then(a=>{let m=a.address;return{city:m.city||m.town||m.village||m.state,commune:m.suburb||m.neighbourhood||m.city_district}}).catch(a=>(console.error("Erreur g\xE9ocodage inverse :",a),{}))}static \u0275fac=function(e){return new(e||o)(x(R),x(ve),x(ne),x(O))};static \u0275cmp=b({type:o,selectors:[["app-home"]],hostBindings:function(e,t){e&1&&p("scroll",function(m){return t.onScroll(m)},!1,te)},standalone:!0,features:[y],decls:78,vars:10,consts:[[1,"masthead","responsive-header","pt-0",2,"background","linear-gradient(to right, #0f2027, #203a43, #2c5364)"],[1,"p-3",2,"margin-bottom","8rem","background-color","transparent","text-align","right"],["class","forgot text-white","style","text-decoration: underline;",3,"routerLink",4,"ngIf"],["class","btn btnprofil text-white p-0 position-relative","style","margin-right: 1.5rem;","type","button",3,"click",4,"ngIf"],["class","profile-menu dropdown-menu show","style","right: 1.5rem; top: 3.5rem;",4,"ngIf"],[1,"container","position-relative"],[1,"row","justify-content-center"],[1,"col-xl-6"],[1,"text-center","text-white"],[1,"d-flex","justify-content-center","logo",2,"cursor","pointer",3,"click"],[1,"mb-2","me-3","text-center"],[1,"fas","fa-laugh-wink","fa-2x",2,"color","#ffc107","transform","rotate(-30deg)"],["id","contactForm",1,"form-subscribe",3,"ngSubmit","formGroup"],[1,"col-md-7","mb-2"],["formControlName","textSearch","id","textSearch","type","text","placeholder","Tapez ici pour rechercher...",1,"form-control","rounded-pill","shadow-sm",2,"height","45px"],[1,"col-md-auto"],["type","submit",1,"btn","btn-warning","rounded-pill","px-3","shadow-sm",2,"height","45px","line-height","1",3,"disabled"],["class","spinner-overlay",4,"ngIf"],[1,"position-relative",2,"min-height","80px"],["class","position-absolute top-50 start-50 translate-middle text-white text-center",4,"ngIf"],[1,"m-5"],["class","row mt-4",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"showcase"],[1,"text-center","mb-4"],[1,"container-fluid","p-0"],[1,"row","g-0"],[1,"col-lg-6","order-lg-2","text-white","showcase-img",2,"background-image","url('assets/img/bg-showcase-1.jpg')"],[1,"col-lg-6","order-lg-1","my-auto","showcase-text"],[1,"lead","mb-0"],[1,"col-lg-6","text-white","showcase-img",2,"background-image","url('assets/img/bg-showcase-2.jpg')"],[1,"col-lg-6","my-auto","showcase-text"],[1,"col-lg-6","order-lg-2","text-white","showcase-img",2,"background-image","url('assets/img/bg-showcase-3.jpg')"],[1,"features-icons","bg-white","text-center","py-5"],[1,"container"],[1,"mb-5","fw-bold"],[1,"row"],[1,"col-lg-4"],[1,"mb-4"],[1,"bi","bi-phone","display-4","text-warning"],[1,"mt-3"],[1,"bi","bi-lightning-charge","display-4","text-primary"],[1,"bi","bi-stars","display-4","text-success"],["id","backToTopBtn","style","background: none; border: none; color: black; font-size: 1.2rem; cursor: pointer;",3,"click",4,"ngIf"],[1,"forgot","text-white",2,"text-decoration","underline",3,"routerLink"],["type","button",1,"btn","btnprofil","text-white","p-0","position-relative",2,"margin-right","1.5rem",3,"click"],[1,"bi","bi-person-circle","fs-4"],[1,"profile-menu","dropdown-menu","show",2,"right","1.5rem","top","3.5rem"],[1,"dropdown-item","d-flex","align-items-center","gap-2",3,"routerLink"],[1,"bi","bi-person-fill"],[1,"bi","bi-star-fill"],[1,"dropdown-item","d-flex","align-items-center","gap-2",3,"click"],[1,"bi","bi-box-arrow-right"],[1,"spinner-overlay"],[1,"spinner"],[1,"position-absolute","top-50","start-50","translate-middle","text-white","text-center"],[1,"m-0"],[1,"row","mt-4"],["class","col-md-4 col-12",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-md-4","col-12",3,"ngClass"],[1,"card","mb-3","position-relative"],["title","Ajouter aux favoris",1,"btn","btn-fav",3,"click","ngClass"],[1,"fas",3,"ngClass"],[1,"col-md-4"],[1,"img-fluid","rounded-start","h-100","object-fit-cover",3,"src","alt"],[1,"col-md-8"],[1,"card-body"],[1,"card-title","fw-bold","text-black"],[1,"card-text","text-muted"],[1,"card-text","m-0"],[1,"bi","bi-geo-alt-fill","text-secondary"],[1,"bi","bi-house-fill","text-secondary"],[1,"mt-3","text-end"],["type","button","onmouseover","this.style.background='linear-gradient(135deg, #ffc107, #6d5203)'","onmouseout","this.style.background='linear-gradient(135deg, #6d5203, #ffc107)'",1,"btn","btn-sm","d-inline-flex","align-items-center","gap-2","rounded-pill","shadow","viewbusiness",3,"click"],[1,"bi","bi-eye-fill",2,"font-size","1rem"],[1,"text-center"],[1,"btn","btn-outline-primary","showAll",3,"click"],["id","backToTopBtn",2,"background","none","border","none","color","black","font-size","1.2rem","cursor","pointer",3,"click"]],template:function(e,t){if(e&1&&(n(0,"header",0)(1,"div",1),f(2,Me,2,2,"a",2)(3,Oe,2,0,"button",3)(4,Ae,10,4,"div",4),s(),n(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),p("click",function(){return t.navigateToHome()}),n(10,"h1",10),r(11,"Coocle Search"),s(),l(12,"i",11),s(),n(13,"form",12),p("ngSubmit",function(){return t.Searchbusiness()}),n(14,"div",6)(15,"div",13),l(16,"input",14),s(),n(17,"div",15)(18,"button",16),r(19," Search "),s()()(),f(20,Ie,2,0,"div",17),s(),n(21,"div",18),f(22,Pe,3,0,"div",19),s()()()()()(),n(23,"section",20),f(24,Te,2,1,"div",21)(25,Le,3,0,"div",22),s(),n(26,"section",23)(27,"h3",24),r(28,"Autres actualit\xE9s"),s(),n(29,"div",25)(30,"div",26),l(31,"div",27),n(32,"div",28)(33,"h2"),r(34,"Fully Responsive Design"),s(),n(35,"p",29),r(36,"When you use a theme created by Start Bootstrap, you know that the theme will look great on any device, whether it's a phone, tablet, or desktop the page will behave responsively!"),s()()(),n(37,"div",26),l(38,"div",30),n(39,"div",31)(40,"h2"),r(41,"Updated For Bootstrap 5"),s(),n(42,"p",29),r(43,"Newly improved, and full of great utility classes, Bootstrap 5 is leading the way in mobile responsive web development! All of the themes on Start Bootstrap are now using Bootstrap 5!"),s()()(),n(44,"div",26),l(45,"div",32),n(46,"div",28)(47,"h2"),r(48,"Easy to Use & Customize"),s(),n(49,"p",29),r(50,"Landing Page is just HTML and CSS with a splash of SCSS for users who demand some deeper customization options. Out of the box, just add your content and images, and your new landing page will be ready to go!"),s()()()()(),n(51,"section",33)(52,"div",34)(53,"h2",35),r(54,"Pourquoi utiliser Coocle ?"),s(),n(55,"div",36)(56,"div",37)(57,"div",38),l(58,"i",39),n(59,"h4",40),r(60,"100% Responsive"),s(),n(61,"p"),r(62,"Accessible sur tous les appareils, partout et \xE0 tout moment."),s()()(),n(63,"div",37)(64,"div",38),l(65,"i",41),n(66,"h4",40),r(67,"Ultra Rapide"),s(),n(68,"p"),r(69,"Des r\xE9sultats instantan\xE9s et pertinents \xE0 vos recherches."),s()()(),n(70,"div",37)(71,"div",38),l(72,"i",42),n(73,"h4",40),r(74,"Simple & Intuitif"),s(),n(75,"p"),r(76,"Une interface agr\xE9able et facile \xE0 utiliser pour tous."),s()()()()()(),f(77,He,2,0,"button",43)),e&2){let a;c(2),d("ngIf",!t.isLoggedIn),c(),d("ngIf",t.user_infos),c(),d("ngIf",t.profileMenuVisible),c(9),d("formGroup",t.search_form),c(5),d("disabled",((a=t.search_form.get("textSearch"))==null?null:a.invalid)||((a=t.search_form.get("textSearch"))==null?null:a.value.trim())===""),c(2),d("ngIf",t.loading),c(2),d("ngIf",(t.textSearch||t.searchDone)&&t.All_business.length===0),c(2),d("ngIf",t.All_business.length>0),c(),d("ngIf",t.All_business.length>t.visibleCount),c(52),d("ngIf",t.backToTopBtnVisible)}},dependencies:[M,ue,re,le,ce,pe,fe,C,B,N,V,_,se],styles:['@charset "UTF-8";a[_ngcontent-%COMP%]{color:#000;text-decoration:none;cursor:pointer}.forgot[_ngcontent-%COMP%]{color:#3131f7;text-decoration:underline;cursor:pointer;position:relative;z-index:10}#backToTopBtn[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;display:block;border-radius:50%;padding:10px;font-size:20px;background-color:#007bff;color:#fff;border:none;cursor:pointer;z-index:1000}#backToTopBtn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.profile-menu[_ngcontent-%COMP%]{position:absolute;z-index:1050;min-width:170px;background:#fff;border:1px solid #ccc;border-radius:.5rem;box-shadow:0 4px 12px #00000026}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:active, .profile-menu[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%]{background-color:transparent!important;color:inherit!important}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{transition:background-color .2s ease,color .2s ease;border-radius:.375rem}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#4d7a8d;color:#000}.viewbusiness[_ngcontent-%COMP%]{background:linear-gradient(to right,#0f2027,#203a43,#2c5364);color:#fff;padding:.2rem .5rem;font-weight:500;transition:all .3s ease;border:0}.showAll[_ngcontent-%COMP%]{border:solid,1px,#0f2027;color:#203a43}.showAll[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#a37b04,#dda706);color:#fff;border:solid,1px,#a37b04}.spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff9;display:flex;justify-content:center;align-items:center;z-index:9999}.spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:5px solid #ccc;border-top-color:#0f2027;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.btn-fav[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#fff;color:#2c5364;border:none;font-size:1.3rem;z-index:10;border-radius:50%;padding:6px 10px;box-shadow:0 2px 6px #0000001a;transition:transform .2s ease}.btn-fav[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.btn-fav.active[_ngcontent-%COMP%]{color:#ffc107}@media (max-width: 576px){.responsive-header[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:1rem!important;margin-bottom:3rem!important}.responsive-header[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;margin-top:-3rem}.responsive-header[_ngcontent-%COMP%]   .btnprofil[_ngcontent-%COMP%]{margin-top:-.5rem!important;margin-right:0rem!important}.responsive-header[_ngcontent-%COMP%]   .profile-menu[_ngcontent-%COMP%]{margin-top:-1rem!important;margin-right:-1rem!important}.responsive-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .responsive-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem!important}.responsive-header[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:1rem}}.logo[_ngcontent-%COMP%]{cursor:pointer}.shadow-sm[_ngcontent-%COMP%]{border:0}@media (min-width: 768px) and (max-width: 991.98px){.tablet-fullwidth[_ngcontent-%COMP%]{flex:0 0 100%;max-width:100%}}']})};var z=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user"]],standalone:!0,features:[y],decls:1,vars:0,template:function(e,t){e&1&&l(0,"router-outlet")},dependencies:[_,oe]})};var U=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-favoris"]],standalone:!0,features:[y],decls:31,vars:0,consts:[[1,"m-5","text-start"],[1,"favorites-container"],[1,"favorite-card"],[1,"card-header"],[1,"fas","fa-store","me-2"],[1,"fas","fa-heart","icon-fav"],[1,"card-description"],[1,"card-footer"],["onmouseover","this.style.background='linear-gradient(135deg, #ffc107, #6d5203)'","onmouseout","this.style.background='linear-gradient(135deg, #6d5203, #ffc107)'",1,"btn"],[1,"fas","fa-utensils","me-2"]],template:function(e,t){e&1&&(l(0,"app-header"),n(1,"section")(2,"h1",0),r(3,"Mes Favoris"),s(),n(4,"div",1)(5,"div",2)(6,"div",3)(7,"h3"),l(8,"i",4),r(9," Boutique Omega"),s(),l(10,"i",5),s(),n(11,"div",6),r(12," Sp\xE9cialiste en v\xEAtements de luxe pour hommes. Situ\xE9 \xE0 Abidjan, Cocody Angr\xE9. "),s(),n(13,"div",7)(14,"button",8),r(15,"Voir"),s(),n(16,"button",8),r(17,"Retirer"),s()()(),n(18,"div",2)(19,"div",3)(20,"h3"),l(21,"i",9),r(22," Chicken Palace"),s(),l(23,"i",5),s(),n(24,"div",6),r(25," Restaurant sp\xE9cialis\xE9 en poulet brais\xE9. Livraison rapide \xE0 domicile. "),s(),n(26,"div",7)(27,"button",8),r(28,"Voir"),s(),n(29,"button",8),r(30,"Retirer"),s()()()()())},dependencies:[M,C,_,j]})};var Be=o=>({active:o});function Ne(o,i){if(o&1){let e=h();n(0,"div",12)(1,"div",13)(2,"button",14),p("click",function(){let a=g(e).$implicit,m=u(3);return v(m.toggleFavorite(a))}),l(3,"i",15),s(),n(4,"div",16)(5,"div",17),l(6,"img",18),s(),n(7,"div",19)(8,"div",20)(9,"h5",21),r(10),s(),n(11,"p",22),r(12),s(),n(13,"p",23),l(14,"i",24),r(15),s(),n(16,"p",23),l(17,"i",25),r(18),s(),n(19,"div",26)(20,"button",27),p("click",function(){let a=g(e).$implicit,m=u(3);return v(m.readSingleBusiness(a.bu_uid))}),l(21,"i",28),r(22," Voir "),s()()()()()()()}if(o&2){let e=i.$implicit,t=u(3);c(2),d("ngClass",I(8,Be,t.isFavorite(e))),c(),d("ngClass",t.isFavorite(e)?"fa-heart":"fa-heart-broken"),c(3),L("alt",e.bu_name),d("src",e.bu_image1||"assets/img/default.png",T),c(4),E(e.bu_name),c(2),E(e.bu_description),c(3),k(" ",e.bu_city," "),c(3),k(" ",e.bu_address," ")}}function Ve(o,i){if(o&1&&(G(0),f(1,Ne,23,10,"div",11),W()),o&2){let e=u(2);c(),d("ngForOf",e.favs_List.slice(0,e.visibleCount))}}function Re(o,i){o&1&&(n(0,"div",29),l(1,"i",30)(2,"br"),r(3," Aucun favori trouv\xE9. "),s())}function je(o,i){if(o&1&&(n(0,"div",9),f(1,Ve,2,1,"ng-container",10)(2,Re,4,0,"ng-template",null,0,Q),s()),o&2){let e=K(3),t=u();c(),d("ngIf",t.favs_List.length>0)("ngIfElse",e)}}function De(o,i){if(o&1){let e=h();n(0,"div",33)(1,"div",34)(2,"h5",35),l(3,"i",36),r(4),s(),l(5,"i",37),s(),n(6,"p",38),r(7),s(),n(8,"div",39)(9,"button",40),p("click",function(){let a=g(e).$implicit,m=u(3);return v(m.deleteHistorique(a.h_uid))}),l(10,"i",41),s(),n(11,"button",42),p("click",function(){let a=g(e).$implicit,m=u(3);return v(m.readSingleBusiness(a.bu_uid))}),l(12,"i",43),s()()()}if(o&2){let e=i.$implicit;c(4),k(" ",e.bu_name," "),c(3),E(e.bu_description)}}function ze(o,i){if(o&1&&(G(0),f(1,De,13,2,"div",32),W()),o&2){let e=u(2);c(),d("ngForOf",e.histo_List)}}function Ue(o,i){o&1&&(n(0,"div",44),l(1,"i",45),n(2,"p"),r(3,"Aucun historique disponible pour le moment."),s()())}function qe(o,i){if(o&1&&(n(0,"div",31),f(1,ze,2,1,"ng-container",10)(2,Ue,4,0,"ng-template",null,1,Q),s()),o&2){let e=K(3),t=u();c(),d("ngIf",t.histo_List.length>0)("ngIfElse",e)}}function Je(o,i){o&1&&(n(0,"div",46),l(1,"div",47),s())}var q=class o{constructor(i,e){this.router=i;this.http=e}favs_List=[];histo_List=[];user_infos;user_id;bu_name;businessList=[];favoriteList=[];loading=!1;currentTab="favoris";readAllFavorisByUser(){this.loading=!0;let i={user_id:this.user_id};this.http.ReadAllFavorisByUser(i).subscribe({next:e=>{console.log("response favs_List:",e),e?.status==="success"&&Array.isArray(e.favs_informations)?setTimeout(()=>{this.loading=!1,this.favs_List=e.favs_informations},1e3):this.favs_List=[]},error:e=>{console.error("Erreur lors du chargement :",e),this.favs_List=[]}})}readAllHistoriqueByUser(){this.loading=!0;let i={user_id:this.user_id};this.http.ReadAllHistoriqueByUser(i).subscribe({next:e=>{e?.status==="success"?(this.histo_List=e.histo_informations,this.bu_name=e.histo_informations.bu_name,console.log("histo_List:",this.histo_List),console.log("bu_name:",this.bu_name),setTimeout(()=>{this.loading=!1,this.histo_List=e.histo_informations},2e3)):this.histo_List=[]},error:e=>{console.error("Erreur lors du chargement :",e),this.histo_List=[]}})}readSingleBusiness(i){this.router.navigate(["/user/business/readsingle-business",i])}visibleCount=6;get visibleBusinessList(){return this.businessList.slice(0,this.visibleCount)}isFavorite(i){return i.is_favs===1}toggleFavorite(i){this.favoriteList=this.businessList.filter(t=>t.is_favs===1);let e=this.businessList.findIndex(t=>t.bu_uid===i.bu_uid);e>-1&&(this.businessList[e].is_favs=this.businessList[e].is_favs===1?0:1,this.favoriteList=this.businessList.filter(t=>t.is_favs===1),sessionStorage.setItem("businessList",JSON.stringify(this.businessList)),this.businessList[e].is_favs===1?this.saveFavoris(this.businessList[e]):this.deleteFavoris(this.businessList[e])),window.location.reload()}saveFavoris(i){let e=w(S({},i),{user_id:this.user_id});console.log("payload:",e),this.http.SaveFavoris(e).subscribe({next:t=>{console.log("Response:",t.status)},error:t=>{console.error("Erreur lors de la recherche :",t),this.favoriteList=[]}})}deleteFavoris(i){let e=w(S({},i),{user_id:this.user_id});console.log("payload:",e),this.http.DeleteFavoris(e).subscribe({next:t=>{console.log("Response:",t)},error:t=>{console.error("Erreur lors de la recherche :",t),this.favoriteList=[]}})}deleteHistorique(i){let e=w(S({},i),{user_id:this.user_id});console.log("payload:",e),this.http.DeleteHistoriques(e).subscribe({next:t=>{console.log("Response:",t)},error:t=>{console.error("Erreur lors de la recherche :",t),this.favoriteList=[]}}),window.location.reload()}ngOnInit(){let i=sessionStorage.getItem("user_infos");this.user_infos=i,console.log(this.user_infos),i&&(this.user_infos=JSON.parse(i),this.user_id=this.user_infos.u_uid,console.log("user_id:",this.user_id),this.readAllFavorisByUser(),this.readAllHistoriqueByUser());let e=JSON.parse(sessionStorage.getItem("businessList")||"null");e?(console.log("Business infos trouv\xE9 en session:",e),this.businessList=e):console.warn("Aucun Business trouv\xE9 dans sessionStorage")}static \u0275fac=function(e){return new(e||o)(x(R),x(O))};static \u0275cmp=b({type:o,selectors:[["app-activites"]],standalone:!0,features:[y],decls:11,vars:7,consts:[["noFavorites",""],["noHistory",""],[1,"activity-container"],[1,"activity-tabs"],[1,"tab-btn",3,"click"],[1,"activity-content"],["class","favorites-container",4,"ngIf"],["class","history-container",4,"ngIf"],["class","spinner-overlay",4,"ngIf"],[1,"favorites-container"],[4,"ngIf","ngIfElse"],["class","col-md-6",4,"ngFor","ngForOf"],[1,"col-md-6"],[1,"card","mb-3","position-relative"],["title","Ajouter aux favoris",1,"btn","btn-fav",3,"click","ngClass"],[1,"fas",3,"ngClass"],[1,"row","g-0"],[1,"col-md-4"],[1,"img-fluid","rounded-start","h-100","object-fit-cover",3,"src","alt"],[1,"col-md-8"],[1,"card-body"],[1,"card-title","fw-bold","text-black"],[1,"card-text","text-muted"],[1,"card-text","m-0"],[1,"bi","bi-geo-alt-fill","text-secondary"],[1,"bi","bi-house-fill","text-secondary"],[1,"mt-3","text-end"],["type","button","onmouseover","this.style.background='linear-gradient(135deg, #ffc107, #6d5203)'","onmouseout","this.style.background='linear-gradient(135deg, #6d5203, #ffc107)'",1,"btn","btn-sm","d-inline-flex","align-items-center","gap-2","rounded-pill","shadow","viewbusiness",3,"click"],[1,"bi","bi-eye-fill",2,"font-size","1rem"],[1,"text-center","mt-4","text-muted"],[1,"fas","fa-heart-broken","fa-2x","mb-2"],[1,"history-container"],["class","history-card card shadow-sm mb-4 p-3 rounded-4 border-0",4,"ngFor","ngForOf"],[1,"history-card","card","shadow-sm","mb-4","p-3","rounded-4","border-0"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"mb-0","fw-bold","text-dark"],[1,"fas","fa-history","me-2","text-primary"],[1,"fas","fa-clock","text-muted"],[1,"text-muted","mb-3"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-outline-danger","btn-sm","rounded-pill","shadow-sm","px-3",3,"click"],[1,"bi","bi-trash-fill"],["type","button",1,"btn","btn-sm","rounded-pill","shadow-sm","px-3","show",3,"click"],[1,"bi","bi-eye-fill"],[1,"text-center","mt-5","text-muted"],[1,"fas","fa-history","fa-2x","mb-3","d-block"],[1,"spinner-overlay"],[1,"spinner"]],template:function(e,t){e&1&&(l(0,"app-header"),n(1,"div",2)(2,"div",3)(3,"button",4),p("click",function(){return t.currentTab="favoris"}),r(4,"Favoris"),s(),n(5,"button",4),p("click",function(){return t.currentTab="historique"}),r(6,"Historique"),s()(),n(7,"div",5),f(8,je,4,2,"div",6),s(),f(9,qe,4,2,"div",7)(10,Je,2,0,"div",8),s()),e&2&&(c(3),$("active",t.currentTab==="favoris"),c(2),$("active",t.currentTab==="historique"),c(3),d("ngIf",t.currentTab==="favoris"),c(),d("ngIf",t.currentTab==="historique"),c(),d("ngIf",t.loading))},dependencies:[M,C,B,N,V,_,j],styles:[".activity-container[_ngcontent-%COMP%]{max-width:1000px;margin:40px auto;font-family:Segoe UI,sans-serif;padding:20px;background:#f7f9fc;color:#000;border-radius:12px;box-shadow:0 4px 12px #0000001a}.activity-tabs[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:30px}.activity-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:none;padding:12px 30px;margin:0 15px;font-weight:700;font-size:16px;cursor:pointer;color:#333;border-bottom:3px solid transparent;transition:.3s ease}.activity-tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{border-bottom:3px solid #ffc107;color:#ffc107}.favorites-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.favorite-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;border-radius:12px;padding:20px;box-shadow:0 2px 8px #0000000d;transition:box-shadow .3s ease}.favorite-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.card-description[_ngcontent-%COMP%]{font-size:15px;color:#555;margin-bottom:15px}.card-footer[_ngcontent-%COMP%]{display:flex;gap:10px}.spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff9;display:flex;justify-content:center;align-items:center;z-index:9999}.spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:5px solid #ccc;border-top-color:#0f2027;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.viewbusiness[_ngcontent-%COMP%]{background:linear-gradient(to right,#0f2027,#203a43,#2c5364);color:#fff;padding:.2rem .5rem;font-weight:500;transition:all .3s ease;border:0}.btn-fav[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#fff;color:#2c5364;border:none;font-size:1.3rem;z-index:10;border-radius:50%;padding:6px 10px;box-shadow:0 2px 6px #0000001a;transition:transform .2s ease}.btn-fav[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.btn-fav.active[_ngcontent-%COMP%]{color:#ffc107}.activity-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;background:transparent;font-weight:700;color:#666;border-bottom:2px solid transparent;transition:all .3s ease}.activity-tabs[_ngcontent-%COMP%]   .tab-btn.active[_ngcontent-%COMP%]{border-color:#ffc107;color:#000}.btn.viewbusiness[_ngcontent-%COMP%], .show[_ngcontent-%COMP%]{background:linear-gradient(to right,#0f2027,#203a43,#2c5364);color:#fff;transition:background .3s ease}.btn.viewbusiness[_ngcontent-%COMP%]:hover, .show[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ffc107,#6d5203)}.btn-danger-hover[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a71d2a,#dc3545)}.btn-danger-hover[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#dc3545,#a71d2a)}"]})};var $e=[{path:"",component:z,children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:D},{path:"activites",component:q},{path:"favoris",component:U},{path:"business",loadChildren:()=>import("./chunk-7SBVTTVT.js").then(o=>o.BusinessModule)}]}],J=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=F({type:o});static \u0275inj=P({imports:[_.forChild($e),_]})};var be=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=F({type:o});static \u0275inj=P({imports:[C,J]})};export{be as UserModule};
