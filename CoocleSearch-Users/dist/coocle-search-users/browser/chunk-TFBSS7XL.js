import{a as T,b as L,c as F,d as H,e as N,f as A,g as V,h as B,i as z,l as j,m as D}from"./chunk-QXD6ON7B.js";import{A as v,E as m,G as o,I as r,J as s,K as l,N as x,O as p,P as g,T as c,X as w,Y as d,ha as k,ia as I,ja as M,k as S,n as y,o as C,oa as O,pa as P,ra as E,s as _,t as b,z as a}from"./chunk-NDQ5UUJF.js";var h=class n{constructor(t){this.http=t}api_url=D.apiUrl;SearchBusinessByCategorie(t){return this.http.post(this.api_url+"/api/business/searchbusinessbycategorie",t)}ReadSingleBusiness(t){return this.http.post(this.api_url+"/api/business/readsinglebusiness",t)}CreateStats(t){return this.http.post(this.api_url+"/api/stats/create_stats",t)}static \u0275fac=function(i){return new(i||n)(y(M))};static \u0275prov=S({token:n,factory:n.\u0275fac,providedIn:"root"})};var R=()=>["/user/home"],G=()=>["/auth/login/"],U=()=>["/profil"],q=()=>["/user/activites"];function W(n,t){n&1&&(r(0,"a",23),c(1,"Connexion"),s()),n&2&&o("routerLink",d(1,G))}function X(n,t){if(n&1){let i=x();r(0,"button",24),p("click",function(){_(i);let u=g();return b(u.toggleProfileMenu())}),l(1,"i",25),s()}}function Y(n,t){n&1&&(r(0,"div",26)(1,"a",27),l(2,"i",28),c(3," Profil "),s(),r(4,"a",27),l(5,"i",29),c(6," Activit\xE9s "),s()()),n&2&&(a(),o("routerLink",d(2,U)),a(3),o("routerLink",d(3,q)))}function Z(n,t){n&1&&(r(0,"div",30),l(1,"div",31),s())}function $(n,t){n&1&&(r(0,"a",32),c(1,"Connexion"),s()),n&2&&o("routerLink",d(1,G))}function ee(n,t){n&1&&(r(0,"div",36)(1,"a",27),l(2,"i",28),c(3," Profil "),s(),r(4,"a",27),l(5,"i",29),c(6," Activit\xE9s "),s()()),n&2&&(a(),o("routerLink",d(2,U)),a(3),o("routerLink",d(3,q)))}function te(n,t){if(n&1){let i=x();r(0,"div",33)(1,"button",34),p("click",function(){_(i);let u=g();return b(u.toggleProfileMenu())}),l(2,"i",25),s(),m(3,ee,7,4,"div",35),s()}if(n&2){let i=g();a(3),o("ngIf",i.profileMenuVisible)}}var J=class n{constructor(t,i){this.router=t;this.http=i}All_business;user_id;coordonne;localisation;search_form=new N({textSearch:new A(null,L.required)});profileMenuVisible=!1;user_infos;isLoggedIn=!1;businessList=[];searchDone=!1;backToTopBtnVisible=!1;loading=!1;toggleProfileMenu(){this.profileMenuVisible=!this.profileMenuVisible}Searchbusiness(){this.loading=!0;let t=this.search_form.get("textSearch")?.value.trim();if(!t)return;let i={textSearch:t,user_id:this.user_id,latitude:this.coordonne.latitude,longitude:this.coordonne.longitude};this.http.SearchBusinessByCategorie(i).subscribe({next:e=>{console.log("Response:",e),e?.status==="success"&&Array.isArray(e.business)?(setTimeout(()=>{this.loading=!1,this.All_business=e.business,this.searchDone=!0},2e3),e.business&&(sessionStorage.setItem("All_business",JSON.stringify(e.business)),sessionStorage.setItem("businessList",JSON.stringify(e.business)),sessionStorage.setItem("textSearch",JSON.stringify(e.textSearch)))):(this.All_business=[],sessionStorage.setItem("All_business",JSON.stringify(this.All_business)),sessionStorage.setItem("textSearch",JSON.stringify(e.textSearch)),this.loading=!1,this.searchDone=!0),this.router.navigate(["/user/home"])},error:e=>{console.error("Erreur lors de la recherche :",e),this.searchDone=!0,this.All_business=[],e.error instanceof ProgressEvent?console.log("Erreur li\xE9e \xE0 un mauvais format JSON ou content-type."):console.log("R\xE9ponse du serveur :",e.error)}}),this.createStats()}createStats(){let t=this.search_form.get("textSearch")?.value.trim();if(!t)return;let i={textSearch:t,all_business_found:this.All_business,city:this.localisation.city,commune:this.localisation.commune,longitude:this.coordonne.longitude,latitude:this.coordonne.latitude};this.http.CreateStats(i).subscribe({next:e=>{e?.status==="success"&&console.log("message: ",e.message)},error:e=>{console.error("Failed to load products:",e)}})}ngOnInit(){let t=sessionStorage.getItem("user_infos");this.isLoggedIn=!!t,this.user_infos=t;let i=JSON.parse(sessionStorage.getItem("localisation")||"null");i?(console.log("localisation infos trouv\xE9 en session:",i),this.localisation=i):console.warn("Aucun localisation trouv\xE9 dans sessionStorage");let e=JSON.parse(sessionStorage.getItem("coordonne")||"null");e?(console.log("coordonne infos trouv\xE9 en session:",e),this.coordonne=e):console.warn("Aucun coordonne trouv\xE9 dans sessionStorage")}static \u0275fac=function(i){return new(i||n)(v(O),v(h))};static \u0275cmp=C({type:n,selectors:[["app-header"]],standalone:!0,features:[w],decls:32,vars:14,consts:[[1,"page-header","py-3","header",2,"background","linear-gradient(to right, #0f2027, #203a43, #2c5364)"],[1,"container-fluid"],[1,"row","align-items-center","text-white"],[1,"col-12","d-flex","justify-content-between","align-items-center","mb-3","d-md-none"],[1,"d-flex","align-items-center","logo","logo-group",3,"routerLink"],[1,"mb-0","me-2","logo-title"],[1,"fas","fa-laugh-wink","logo-icon",2,"transform","rotate(-30deg)","color","white"],["class","text-white me-3","style","text-decoration: underline;",3,"routerLink",4,"ngIf"],["class","btn text-white p-0 position-relative","type","button",3,"click",4,"ngIf"],["class","dropdown-menu show","style","right: 0.5rem; top: 3.5rem; position: absolute;",4,"ngIf"],[1,"col-12","mb-3","d-md-none"],["id","contactForm",1,"form-subscribe",3,"ngSubmit","formGroup"],[1,"input-group","shadow-sm",2,"height","45px"],["formControlName","textSearch","id","textSearch","type","text","placeholder","Tapez ici pour rechercher...",1,"form-control","border-0","rounded-start-pill",2,"height","100%"],["type","submit",1,"btn","btn-warning","border-0","rounded-end-pill","px-4",2,"height","100%",3,"disabled"],["class","spinner-overlay",4,"ngIf"],[1,"col-md-4","logo","d-none","d-md-flex","align-items-center","justify-content-start","text-white",3,"routerLink"],[1,"mb-0","me-2"],[1,"fas","fa-laugh-wink","fa-2x",2,"transform","rotate(-30deg)","color","white"],[1,"col-md-5","d-none","d-md-block","tablet-adjust"],[1,"col-md-3","d-none","d-md-flex","justify-content-end","align-items-center","text-white"],["class","me-3 text-white","style","text-decoration: underline;",3,"routerLink",4,"ngIf"],["class","position-relative",4,"ngIf"],[1,"text-white","me-3",2,"text-decoration","underline",3,"routerLink"],["type","button",1,"btn","text-white","p-0","position-relative",3,"click"],[1,"bi","bi-person-circle","fs-4"],[1,"dropdown-menu","show",2,"right","0.5rem","top","3.5rem","position","absolute"],[1,"dropdown-item","d-flex","align-items-center","gap-2",3,"routerLink"],[1,"bi","bi-person-fill"],[1,"bi","bi-star-fill"],[1,"spinner-overlay"],[1,"spinner"],[1,"me-3","text-white",2,"text-decoration","underline",3,"routerLink"],[1,"position-relative"],["type","button",1,"btn","text-white","p-0","position-relative",2,"margin-left","1.5rem",3,"click"],["class","profile-menu dropdown-menu show","style","right: 1.5rem; top: 3.5rem;",4,"ngIf"],[1,"profile-menu","dropdown-menu","show",2,"right","1.5rem","top","3.5rem"]],template:function(i,e){if(i&1&&(r(0,"header",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),c(6,"Coocle Search"),s(),l(7,"i",6),s(),r(8,"div"),m(9,W,2,2,"a",7)(10,X,2,0,"button",8)(11,Y,7,4,"div",9),s()(),r(12,"div",10)(13,"form",11),p("ngSubmit",function(){return e.Searchbusiness()}),r(14,"div",12),l(15,"input",13),r(16,"button",14),c(17," Search "),s()(),m(18,Z,2,0,"div",15),s()(),r(19,"div",16)(20,"h2",17),c(21,"Coocle Search"),s(),l(22,"i",18),s(),r(23,"div",19)(24,"form",11),p("ngSubmit",function(){return e.Searchbusiness()}),r(25,"div",12),l(26,"input",13),r(27,"button",14),c(28," Search "),s()()()(),r(29,"div",20),m(30,$,2,2,"a",21)(31,te,4,1,"div",22),s()()()()),i&2){let u,f;a(4),o("routerLink",d(12,R)),a(5),o("ngIf",!e.isLoggedIn),a(),o("ngIf",e.user_infos),a(),o("ngIf",e.profileMenuVisible),a(2),o("formGroup",e.search_form),a(3),o("disabled",((u=e.search_form.get("textSearch"))==null?null:u.invalid)||((u=e.search_form.get("textSearch"))==null?null:u.value.trim())===""),a(2),o("ngIf",e.loading),a(),o("routerLink",d(13,R)),a(5),o("formGroup",e.search_form),a(3),o("disabled",((f=e.search_form.get("textSearch"))==null?null:f.invalid)||((f=e.search_form.get("textSearch"))==null?null:f.value.trim())===""),a(3),o("ngIf",!e.isLoggedIn),a(),o("ngIf",e.user_infos)}},dependencies:[j,V,T,F,H,B,z,I,k,E,P],styles:['@charset "UTF-8";.header[_ngcontent-%COMP%]{background:linear-gradient(to right,#0f2027,#203a43,#2c5364);box-shadow:0 2px 5px #0003}.rotate-n-15[_ngcontent-%COMP%]{color:#ff0;transform:rotate(15deg);display:inline-block}nav[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;z-index:1000;transition:top .3s ease}a[_ngcontent-%COMP%]{color:#000;text-decoration:none}.forgot[_ngcontent-%COMP%]{color:#3131f7;text-decoration:underline;cursor:pointer;position:relative;z-index:10}#backToTopBtn[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;display:block;border-radius:50%;padding:10px;font-size:20px;background-color:#007bff;color:#fff;border:none;cursor:pointer;z-index:1000}#backToTopBtn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.profile-menu[_ngcontent-%COMP%]{position:absolute;z-index:1050;min-width:170px;background:#fff;border:1px solid #ccc;border-radius:.5rem;box-shadow:0 4px 12px #00000026}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:active, .profile-menu[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%]{background-color:transparent!important;color:inherit!important}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{transition:background-color .2s ease,color .2s ease;border-radius:.375rem}.profile-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#4d7a8d;color:#000}.logo-title[_ngcontent-%COMP%]{font-size:1.6rem}.logo-icon[_ngcontent-%COMP%]{font-size:1.5rem}@media (min-width: 768px) and (max-width: 1264px){.logo-title[_ngcontent-%COMP%]{font-size:1.3rem}.logo-icon[_ngcontent-%COMP%]{font-size:1.2rem}}.logo[_ngcontent-%COMP%]{cursor:pointer}']})};export{h as a,J as b};
