import{a as K}from"./chunk-BSYTQXDF.js";import{a as be}from"./chunk-5FXP5EYW.js";import{a as j,b as h,c as U,d as A,e as q,f as d,g as z,h as G,i as J,j as H,k as L,l as $,n as ue,o as de,p as I,q as me}from"./chunk-MC74N3Z2.js";import{$ as M,A as c,E as y,G as l,I as n,J as i,K as u,L as R,M as g,N as C,O as s,P as p,Q as S,S as x,_ as V,aa as _,ba as ae,d as ge,ea as B,fa as le,ga as O,ja as f,k as oe,l as F,n as re,p as b,q as D,t as k,u as N,y as w,z as a}from"./chunk-5VA7YNX3.js";var Q=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=b({type:r,selectors:[["app-business"]],standalone:!0,features:[x],decls:1,vars:0,template:function(e,o){e&1&&u(0,"router-outlet")},dependencies:[f,le,de,_]})};var se=ge(be());var v=class r{constructor(t){this.http=t}api_url=me.apiUrl;CreateBusiness(t){return this.http.post(this.api_url+"/api/business/createbusiness",t)}UpdateBusiness(t){return this.http.post(this.api_url+"/api/business/updatebusiness",t)}ReadAllBusinessByTeller(t){return this.http.post(this.api_url+"/api/business/readallbusinessbyteller",t)}ReadSingleBusiness(t){return this.http.post(this.api_url+"/api/business/readsinglebusiness",t)}ReadAllBusinessByCategories(t){return this.http.post(this.api_url+"/api/business/readsinglebusinessbycategories",t)}DeleteBusiness(t){return this.http.post(this.api_url+"/api/business/deletebusiness",t)}static \u0275fac=function(e){return new(e||r)(re(ae))};static \u0275prov=oe({token:r,factory:r.\u0275fac,providedIn:"root"})};function _e(r,t){if(r&1&&(n(0,"option",32),s(1),i()),r&2){let e=t.$implicit;l("value",e),a(),p(e)}}function ve(r,t){r&1&&(n(0,"div",33)(1,"small"),s(2,"Pour une g\xE9olocalisation pr\xE9cise, veuillez \xEAtre pr\xE9sent sur le site de l\u2019entit\xE9 au moment de sa cr\xE9ation."),i()())}function ye(r,t){r&1&&(n(0,"div",6)(1,"label",34),s(2,"Ville "),n(3,"span",8),s(4,"*"),i()(),u(5,"input",35),i())}function Ce(r,t){r&1&&(n(0,"div",6)(1,"label",36),s(2,"Adresse "),n(3,"span",8),s(4,"*"),i()(),u(5,"input",37),i())}var Y=class r{constructor(t,e,o,m){this.router=t;this.fb=e;this.http=o;this.api=m}data=[];latitude;longitude;error;allBusiness=[];business;loading=!1;delayDuration=2e3;success=!1;teller_infos;t_uid;file;localisation;coordonne;city;address;allCategories=[];ngOnInit(){this.loadCategories();let t=sessionStorage.getItem("teller_infos"),e=JSON.parse(sessionStorage.getItem("coordonne")||"null");e&&(this.coordonne=e),this.teller_infos=t,t&&(this.teller_infos=JSON.parse(t),this.t_uid=this.teller_infos.t_uid,this.createbusiness.patchValue({t_uid:this.t_uid,latitude:this.coordonne.latitude,longitude:this.coordonne.longitude}));let o=JSON.parse(sessionStorage.getItem("localisation")||"null");o&&(this.localisation=o,this.city=this.localisation.infos_maps.state+", "+this.localisation.infos_maps.city,this.address=this.localisation.infos_maps.neighbourhood+", "+this.localisation.infos_maps.road),this.createbusiness.get("type")?.valueChanges.subscribe(m=>{m==="physique"?this.createbusiness.patchValue({city:this.city,address:this.address}):this.createbusiness.patchValue({city:"",address:""})})}get typeValue(){return this.createbusiness.get("type")?.value}loadCategories(){this.api.ReadAllCategories()?.subscribe({next:t=>{this.data=t?.categorie_name,this.allCategories=this.data.map(e=>e?.name),console.log(this.allCategories)}})}createbusiness=new q({categorie:new d(null,h.required),type:new d(null,h.required),name:new d(null,h.required),description:new d(null,h.required),email:new d(null,h.required),city:new d(null),address:new d(null),phone:new d(null,h.required),bu_picture:new d(null,h.required),t_uid:new d(null,h.required),latitude:new d(null,h.required),longitude:new d(null,h.required)});onFileChange(t){console.log(t);let e=t.target.files[0];return this.file=e,console.log(this.file),e}Createbusiness(){if(this.createbusiness.valid){this.loading=!0;let t=new FormData;t.append("categorie",this.createbusiness.get("categorie")?.value),t.append("type",this.createbusiness.get("type")?.value),t.append("name",this.createbusiness.get("name")?.value),t.append("description",this.createbusiness.get("description")?.value),t.append("email",this.createbusiness.get("email")?.value),t.append("city",this.createbusiness.get("city")?.value),t.append("address",this.createbusiness.get("address")?.value),t.append("phone",this.createbusiness.get("phone")?.value),t.append("bu_picture",this.file),t.append("t_uid",this.createbusiness.get("t_uid")?.value),t.append("latitude",this.createbusiness.get("latitude")?.value),t.append("longitude",this.createbusiness.get("longitude")?.value),this.http.CreateBusiness(t).subscribe({next:e=>{console.log(e),e?.status==="success"?(this.data=e,se.default.fire({title:"Succ\xE8s !",text:"L'entit\xE9 a \xE9t\xE9 cr\xE9\xE9e avec succ\xE8s !",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#dda706"}).then(()=>{window.location.reload()})):se.default.fire({title:"Erreur !",text:e?.error_description||"\xC9chec de cr\xE9ation.",icon:"error",confirmButtonText:"R\xE9essayer",confirmButtonColor:"#ff6c2f"})},error:e=>{console.error(e),setTimeout(()=>{this.loading=!1},this.delayDuration)}})}}navigateToRead(){this.router.navigate(["/teller/business/readall-business"])}GetLocalisation(){}static \u0275fac=function(e){return new(e||r)(c(O),c(ue),c(v),c(K))};static \u0275cmp=b({type:r,selectors:[["app-create-business"]],standalone:!0,features:[x],decls:67,vars:6,consts:[[1,"container","my-5","p-5","shadow","bg-white","rounded"],[1,"text-center","mb-4","fw-bold","text-dark"],["enctype","multipart/form-data",1,"row","g-4",3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"card","p-3","border-0","shadow-sm"],[1,"text-primary"],[1,"form-group","mt-2"],["for","categorie"],[1,"text-danger"],["formControlName","categorie",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["for","type"],["formControlName","type",1,"form-select"],["value","physique"],["value","en-ligne"],["for","name"],["type","text","formControlName","name","id","name",1,"form-control"],["for","description"],["formControlName","description","id","description","rows","3",1,"form-control"],["for","email"],["type","email","formControlName","email","id","email",1,"form-control"],[1,"form-check","mt-3"],["type","checkbox","id","terms",1,"form-check-input"],["for","terms",1,"form-check-label"],["class","form-check p-0 alert alert-warning text-dark mt-3","role","alert",4,"ngIf"],["class","form-group mt-2",4,"ngIf"],["for","phone"],["type","text","formControlName","phone","id","phone",1,"form-control"],["for","bu_picture"],["type","file","formControlName","bu_picture","id","bu_picture",1,"form-control",3,"change"],[1,"col-12","text-center","mt-4"],["type","submit",1,"btn","btn-warning","px-5","py-2","rounded-pill","shadow",3,"disabled"],[3,"value"],["role","alert",1,"form-check","p-0","alert","alert-warning","text-dark","mt-3"],["for","city"],["type","text","formControlName","city","id","city",1,"form-control"],["for","address"],["type","text","formControlName","address","id","address",1,"form-control"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1),s(2,"Cr\xE9er une Entit\xE9"),i(),n(3,"form",2),g("ngSubmit",function(){return o.Createbusiness()}),n(4,"div",3)(5,"div",4)(6,"h5",5),s(7,"Informations G\xE9n\xE9rales"),i(),n(8,"div",6)(9,"label",7),s(10,"Cat\xE9gorie "),n(11,"span",8),s(12,"*"),i()(),n(13,"select",9),y(14,_e,2,2,"option",10),i()(),n(15,"div",6)(16,"label",11),s(17,"Type "),n(18,"span",8),s(19,"*"),i()(),n(20,"select",12)(21,"option",13),s(22,"Physique"),i(),n(23,"option",14),s(24,"En ligne"),i()()(),n(25,"div",6)(26,"label",15),s(27,"Nom de l'entit\xE9 "),n(28,"span",8),s(29,"*"),i()(),u(30,"input",16),i(),n(31,"div",6)(32,"label",17),s(33,"Description "),n(34,"span",8),s(35,"*"),i()(),u(36,"textarea",18),i(),n(37,"div",6)(38,"label",19),s(39,"Email "),n(40,"span",8),s(41,"*"),i()(),u(42,"input",20),i(),n(43,"div",21),u(44,"input",22),n(45,"label",23),s(46," J'accepte les conditions g\xE9n\xE9rales d'utilisation "),i()()()(),n(47,"div",3)(48,"div",4),y(49,ve,3,0,"div",24)(50,ye,6,0,"div",25)(51,Ce,6,0,"div",25),n(52,"div",6)(53,"label",26),s(54,"T\xE9l\xE9phone "),n(55,"span",8),s(56,"*"),i()(),u(57,"input",27),i(),n(58,"div",6)(59,"label",28),s(60,"Picture "),n(61,"span",8),s(62,"*"),i()(),n(63,"input",29),g("change",function(P){return o.onFileChange(P)}),i()()()(),n(64,"div",30)(65,"button",31),s(66,"Cr\xE9er l'entit\xE9"),i()()()()),e&2&&(a(3),l("formGroup",o.createbusiness),a(11),l("ngForOf",o.allCategories),a(35),l("ngIf",o.typeValue==="physique"),a(),l("ngIf",o.typeValue==="physique"),a(),l("ngIf",o.typeValue==="physique"),a(14),l("disabled",o.createbusiness.invalid))},dependencies:[f,_,V,M,I,z,L,$,j,H,U,A,G,J],styles:["input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{color:#000!important}label[_ngcontent-%COMP%]{color:#444;font-weight:500}.card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-outline-dark[_ngcontent-%COMP%]:hover{background-color:#333;color:#fff}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:1rem!important}.card[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding:1.25rem!important}h2[_ngcontent-%COMP%]{font-size:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.95rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:.95rem;padding:.55rem .75rem}.btn-warning[_ngcontent-%COMP%]{font-size:.95rem;padding:.5rem 2rem}.btn-warning.rounded-pill[_ngcontent-%COMP%]{border-radius:25px!important}.form-check[_ngcontent-%COMP%]{font-size:.9rem}.alert[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.85rem}}@media (max-width: 576px){.container[_ngcontent-%COMP%]{margin:1rem auto}.btn-warning[_ngcontent-%COMP%]{width:100%}.text-center.mt-4[_ngcontent-%COMP%]{margin-top:2rem!important}}"]})};function xe(r,t){if(r&1){let e=R();n(0,"tr")(1,"td",13),s(2),i(),n(3,"td"),u(4,"img",14),i(),n(5,"td",15),s(6),i(),n(7,"td"),s(8),i(),n(9,"td"),s(10),i(),n(11,"td"),s(12),i(),n(13,"td",11)(14,"button",16),g("click",function(){let m=k(e).$implicit,P=C(2);return N(P.Readsinglebusiness(m.bu_uid))}),u(15,"i",17),i()()()}if(r&2){let e=t.$implicit,o=t.index;a(2),p(o+1),a(2),l("src",e.bu_picture||"assets/img/default.jpg",w),a(2),p(e==null?null:e.bu_name),a(2),p(e==null?null:e.bu_categorie),a(2),p(e==null?null:e.bu_type),a(2),p(e==null?null:e.bu_city)}}function Ee(r,t){if(r&1&&(n(0,"table",9)(1,"thead",10)(2,"tr")(3,"th"),s(4,"#"),i(),n(5,"th"),s(6,"Image"),i(),n(7,"th"),s(8,"Nom"),i(),n(9,"th"),s(10,"Cat\xE9gorie"),i(),n(11,"th"),s(12,"Type"),i(),n(13,"th"),s(14,"Ville"),i(),n(15,"th",11),s(16,"Action"),i()()(),n(17,"tbody"),y(18,xe,16,6,"tr",12),i()()),r&2){let e=C();a(18),l("ngForOf",e.dataBusiness)}}function Se(r,t){r&1&&(n(0,"div",18),u(1,"i",19),n(2,"p",20),s(3,"Aucune entit\xE9 disponible pour le moment."),i()())}var Z=class r{constructor(t,e,o,m){this.route=t;this.router=e;this.http=o;this.api=m}allBusiness;teller_infos;t_uid;dataBusiness;ngOnInit(){let t=sessionStorage.getItem("teller_infos");this.teller_infos=t,t&&(this.teller_infos=JSON.parse(t),this.t_uid=this.teller_infos.t_uid),console.log("t_uid: ",this.t_uid),this.Readallbusinessbyteller()}Readallbusinessbyteller(){let t={t_uid:this.t_uid};this.http.ReadAllBusinessByTeller(t).subscribe({next:e=>{this.allBusiness=e,e?.business&&(this.dataBusiness=e?.business,console.log(this.dataBusiness))}})}Readsinglebusiness(t){this.router.navigate(["/teller/business/readsingle-business",t])}static \u0275fac=function(e){return new(e||r)(c(B),c(O),c(v),c(K))};static \u0275cmp=b({type:r,selectors:[["app-readall-business"]],standalone:!0,features:[x],decls:11,vars:3,consts:[[1,"container","mt-5"],[1,"card","shadow-sm","border-0","rounded-4","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"fw-bold","text-dark","m-0"],[1,"bi","bi-building","me-2","text-primary"],[1,"badge","bg-warning","text-dark","fs-6","px-3","py-2","rounded-pill","shadow-sm"],[1,"table-responsive"],["class","table table-hover align-middle",4,"ngIf"],["class","text-center py-5 text-muted",4,"ngIf"],[1,"table","table-hover","align-middle"],[1,"table-light","text-dark"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"fw-semibold"],["alt","",1,"img-fluid","rounded-circle","object-fit-cover",2,"height","35px","width","35px",3,"src"],[1,"fw-semibold","text-dark"],["title","Voir les d\xE9tails",1,"btn","show","btn-sm","btn-outline-primary","rounded-circle","shadow-sm",3,"click"],[1,"bi","bi-eye-fill"],[1,"text-center","py-5","text-muted"],[1,"bi","bi-info-circle","fs-2","mb-2"],[1,"m-0"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),u(4,"i",4),s(5," Mes Entit\xE9s "),i(),n(6,"span",5),s(7),i()(),n(8,"div",6),y(9,Ee,19,1,"table",7)(10,Se,4,0,"div",8),i()()()),e&2&&(a(7),S(" Total : ",(o.dataBusiness==null?null:o.dataBusiness.length)||0," "),a(2),l("ngIf",o.dataBusiness&&o.dataBusiness.length>0),a(),l("ngIf",o.dataBusiness.length===0))},dependencies:[f,_,V,M,I],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.badge[_ngcontent-%COMP%]{font-size:1rem}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#0d6efd;color:#fff;border-color:#0d6efd}.show[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:0px;color:#fff;transition:background .3s ease}.show[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}@media (max-width: 768px){.card.p-4[_ngcontent-%COMP%]{padding:1.2rem!important}h4.fw-bold[_ngcontent-%COMP%]{font-size:1.25rem;text-align:center}.badge.fs-6[_ngcontent-%COMP%]{font-size:.875rem!important;padding:.3rem .6rem!important;display:block;margin:0 auto;text-align:center}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;align-items:center!important;gap:.75rem}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1.2rem;border:1px solid #dee2e6;border-radius:.5rem;padding:.75rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.4rem 0;font-size:.875rem;border:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:600;color:#555;flex-basis:50%;text-align:left}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;width:30px}}@media (max-width: 576px){.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem}.btn.show[_ngcontent-%COMP%]{width:30px;height:30px;padding:0;font-size:.75rem}}']})};var ee=class r{constructor(t,e,o){this.route=t;this.router=e;this.http=o}bu_uid;ville;adresse;all_business=null;ngOnInit(){this.route.params.subscribe(t=>{this.bu_uid=t.bu_uid,console.log("bu_uid re\xE7u:",this.bu_uid);let e=performance.getEntriesByType("navigation");e.length&&e[0].type==="reload"&&(sessionStorage.removeItem("single_business"),console.log("Page recharg\xE9e \u2192 single_business supprim\xE9")),this.readSingleBusiness()})}goBack(){sessionStorage.removeItem("single_business"),this.router.navigate(["/teller/business/readall-business"])}goToUpdate(){this.router.navigate(["/teller/business/update-business",this.all_business.bu_uid])}readSingleBusiness(){let t={bu_uid:this.bu_uid};console.log("Envoi au backend:",t),this.http.ReadSingleBusiness(t).subscribe({next:e=>{console.log("R\xE9ponse backend:",e),e?.status==="success"?(this.all_business=e.business,sessionStorage.setItem("single_business",JSON.stringify(e.business)),console.log("Business re\xE7u:",this.all_business),this.all_business.bu_type==="physique"&&(this.all_business=e.business,this.ville="Ville :",this.adresse="Adresse :")):console.warn("R\xE9ponse sans succ\xE8s")},error:e=>{console.error("Erreur API:",e)}})}static \u0275fac=function(e){return new(e||r)(c(B),c(O),c(v))};static \u0275cmp=b({type:r,selectors:[["app-readsingle-business"]],decls:39,vars:10,consts:[[1,"container","my-5","p-4","shadow","bg-white","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-md-8"],[1,"fw-bold","text-dark","mb-2"],[1,"badge","bg-primary"],[1,"badge","bg-secondary","ms-2","text-capitalize"],[1,"col-md-4","text-end"],[1,"btn","btn-outline-secondary","rounded-pill","me-2",3,"click"],[1,"bi","bi-arrow-left-circle","me-1"],[1,"btn","btn-warning","rounded-pill","shadow-sm",3,"click"],[1,"bi","bi-pencil-square","me-1"],[1,"row","g-4"],[1,"col-md-6"],[1,"mb-3"],["alt","Image principale",1,"img-fluid","h-100","rounded","shadow-sm",3,"src"],[1,"list-group","list-group-flush"],[1,"list-group-item"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),s(4),i(),n(5,"span",4),s(6),i(),n(7,"span",5),s(8),i()(),n(9,"div",6)(10,"button",7),g("click",function(){return o.goBack()}),u(11,"i",8),s(12," Retour "),i(),n(13,"button",9),g("click",function(){return o.goToUpdate()}),u(14,"i",10),s(15," Mettre \xE0 jour "),i()()(),n(16,"div",11)(17,"div",12)(18,"div",13),u(19,"img",14),i()(),n(20,"div",12)(21,"ul",15)(22,"li",16)(23,"strong"),s(24,"Description :"),i(),u(25,"br"),s(26),i(),n(27,"li",16)(28,"strong"),s(29,"T\xE9l\xE9phone :"),i(),s(30),i(),n(31,"li",16)(32,"strong"),s(33),i(),s(34),i(),n(35,"li",16)(36,"strong"),s(37),i(),s(38),i()()()()()),e&2&&(a(4),p(o.all_business.bu_name),a(2),p(o.all_business.bu_categorie),a(2),p(o.all_business.bu_type),a(11),l("src",o.all_business.bu_picture||"assets/img/default.jpg",w),a(7),S(" ",o.all_business.bu_description," "),a(4),S(" ",o.all_business.phone," "),a(3),p(o.adresse),a(),S(" ",o.all_business.bu_address," "),a(3),p(o.ville),a(),S(" ",o.all_business.bu_city," "))},styles:[".list-group-item[_ngcontent-%COMP%]{background-color:transparent;border:none;padding-left:0;padding-right:0}img.img-fluid[_ngcontent-%COMP%]{max-height:300px;object-fit:cover}.goBack[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);color:#fff;border:0px}.goBack[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff;transition:.3s ease}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679);color:#fff}"]})};var te=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=b({type:r,selectors:[["app-delete-business"]],decls:2,vars:0,template:function(e,o){e&1&&(n(0,"p"),s(1,"delete-business works!"),i())}})};function we(r,t){if(r&1&&(n(0,"div",7)(1,"label",30),s(2,"Ville"),i(),u(3,"input",31),i()),r&2){let e=C();a(3),l("readonly",!e.isEditing)}}function Me(r,t){if(r&1&&(n(0,"div",7)(1,"label",32),s(2,"Adresse"),i(),u(3,"input",33),i()),r&2){let e=C();a(3),l("readonly",!e.isEditing)}}function Be(r,t){if(r&1){let e=R();n(0,"button",34),g("click",function(){k(e);let m=C();return N(m.isEditing=!0)}),s(1,"Modifier"),i()}}function Oe(r,t){r&1&&(n(0,"button",35),s(1,"Enregistrer"),i())}function Ie(r,t){if(r&1){let e=R();n(0,"button",36),g("click",function(){k(e);let m=C();return N(m.cancelEdit())}),s(1,"Annuler"),i()}}var ne=class r{constructor(t,e){this.http=t;this.route=e}updatebusiness;all_business;allCategories=[];data;businessId;loading=!1;isEditing=!1;localisation;coordonne;city;file;selectedFile=null;bu_picture="";address;latitude;longitude;ngOnInit(){let t=JSON.parse(sessionStorage.getItem("single_business")||"{}");this.bu_picture=t.bu_picture||"assets/img/default.jpg",console.log("bu_picture: ",this.bu_picture),this.updatebusiness=new q({bu_uid:new d(t.bu_uid||""),bu_type:new d(t.bu_type||""),bu_name:new d(t.bu_name||""),bu_description:new d(t.bu_description||""),bu_city:new d(t.bu_city||""),phone:new d(t.phone||""),bu_address:new d(t.bu_address||""),bu_picture:new d(t.bu_picture||""),latitude:new d(t.latitude||""),longitude:new d(t.longitude||"")});let e=JSON.parse(sessionStorage.getItem("localisation")||"null"),o=JSON.parse(sessionStorage.getItem("coordonne")||"null");e&&(this.localisation=e,this.city=this.localisation.infos_maps.state+", "+this.localisation.infos_maps.city,this.address=this.localisation.infos_maps.neighbourhood+", "+this.localisation.infos_maps.road),o&&(this.coordonne=o,this.latitude=this.coordonne.latitude,this.longitude=this.coordonne.longitude),this.updatebusiness.patchValue({latitude:this.latitude,longitude:this.longitude}),this.updatebusiness.get("type")?.valueChanges.subscribe(m=>{m==="physique"?this.updatebusiness.patchValue({bu_city:this.city,bu_address:this.address}):this.updatebusiness.patchValue({bu_city:"",bu_address:""})})}get typeValue(){return this.updatebusiness.get("type")?.value}onFileChange(t){let e=t.target.files[0];if(e){this.selectedFile=e;let o=URL.createObjectURL(e);this.bu_picture=o}}updateBusiness(){if(this.updatebusiness.valid){this.loading=!0;let t=new FormData;t.append("bu_uid",this.updatebusiness.get("bu_uid")?.value),t.append("bu_type",this.updatebusiness.get("bu_type")?.value),t.append("bu_name",this.updatebusiness.get("bu_name")?.value),t.append("bu_description",this.updatebusiness.get("bu_description")?.value),t.append("bu_city",this.updatebusiness.get("bu_city")?.value),t.append("phone",this.updatebusiness.get("phone")?.value),t.append("bu_address",this.updatebusiness.get("bu_address")?.value),this.selectedFile&&t.append("bu_picture",this.selectedFile),t.append("latitude",this.updatebusiness.get("latitude")?.value),t.append("longitude",this.updatebusiness.get("longitude")?.value),this.http.UpdateBusiness(t).subscribe({next:e=>{if(console.log("Response:",e),e?.status==="success"){let o=this.updatebusiness.value;console.log("Updated Business:",o),sessionStorage.setItem("single_business",JSON.stringify(e.business)),this.isEditing=!1,this.data=e,e.business?this.showSuccessToast("Mise \xE0 jour r\xE9ussie"):this.showErrorToast("Erreur : donn\xE9es incompl\xE8tes")}else this.showErrorToast("\xC9chec de la mise \xE0 jour. Veuillez r\xE9essayer.")},error:e=>{console.error("Erreur :",e),this.showErrorToast("Une erreur est survenue. Veuillez r\xE9essayer.")},complete:()=>{this.loading=!1}})}}cancelEdit(){this.isEditing=!1,this.ngOnInit()}showSuccessToast(t){let e=document.getElementById("successToastBody");e?e.textContent=t:console.warn("Success toast body element not found.");let o=document.getElementById("successToast");new bootstrap.Toast(o,{delay:2e3}).show()}showErrorToast(t){let e=document.getElementById("errorToastBody");e?e.textContent=t:console.warn("Error toast body element not found.");let o=document.getElementById("errorToast");new bootstrap.Toast(o,{delay:2e3}).show()}static \u0275fac=function(e){return new(e||r)(c(v),c(B))};static \u0275cmp=b({type:r,selectors:[["app-update-business"]],standalone:!0,features:[x],decls:50,vars:10,consts:[[1,"container","my-5","p-5","shadow","bg-white","rounded"],[1,"text-center","mb-4","fw-bold","text-dark"],["enctype","multipart/form-data",1,"row","g-4",3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"card","p-3","border-0","shadow-sm"],[1,"text-primary"],["role","alert",1,"form-check","p-0","alert","alert-warning","text-dark"],[1,"form-group","mt-2"],["for","type"],["formControlName","bu_type",1,"form-select"],["value","physique"],["value","en-ligne"],["for","bu_name"],["type","text","formControlName","bu_name","id","bu_name",1,"form-control",3,"readonly"],["for","bu_description"],["formControlName","bu_description","id","bu_description","rows","3",1,"form-control",3,"readonly"],["class","form-group mt-2",4,"ngIf"],[1,"form-group","mt-4"],["for","phone"],["type","text","formControlName","phone","id","phone",1,"form-control",3,"readonly"],[1,"form-group","mt-3"],[1,"mb-2","fw-semibold","text-dark"],["alt","Image actuelle",1,"img-fluid","rounded","shadow-sm","mb-2",2,"max-height","200px",3,"src"],["for","bu_picture"],[1,"text-danger"],["type","file","formControlName","bu_picture","id","bu_picture",1,"form-control",3,"change"],[1,"col-12","text-center","mt-4","button-group"],["type","button","class","btn edit-btn",3,"click",4,"ngIf"],["type","submit","class","btn save-btn",4,"ngIf"],["type","button","class","btn cancel-btn",3,"click",4,"ngIf"],["for","bu_city"],["type","text","formControlName","bu_city","id","bu_city",1,"form-control",3,"readonly"],["for","bu_address"],["type","text","formControlName","bu_address","id","bu_address",1,"form-control",3,"readonly"],["type","button",1,"btn","edit-btn",3,"click"],["type","submit",1,"btn","save-btn"],["type","button",1,"btn","cancel-btn",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1),s(2,"Mettre \xE0 Jour l\u2019Entit\xE9"),i(),n(3,"form",2),g("ngSubmit",function(){return o.updateBusiness()}),n(4,"div",3)(5,"div",4)(6,"h5",5),s(7,"Informations G\xE9n\xE9rales"),i(),n(8,"div",6)(9,"small"),s(10,"Pour une g\xE9olocalisation pr\xE9cise, veuillez \xEAtre pr\xE9sent sur le site de l\u2019entit\xE9."),i()(),n(11,"div",7)(12,"label",8),s(13,"Type"),i(),n(14,"select",9)(15,"option",10),s(16,"Physique"),i(),n(17,"option",11),s(18,"En ligne"),i()()(),n(19,"div",7)(20,"label",12),s(21,"Nom de l'entit\xE9"),i(),u(22,"input",13),i(),n(23,"div",7)(24,"label",14),s(25,"Description"),i(),u(26,"textarea",15),i()()(),n(27,"div",3)(28,"div",4),y(29,we,4,1,"div",16)(30,Me,4,1,"div",16),n(31,"div",17)(32,"label",18),s(33,"T\xE9l\xE9phone"),i(),u(34,"input",19),i(),n(35,"div",20)(36,"label",21),s(37,"Image actuelle"),i(),u(38,"br")(39,"img",22),i(),n(40,"div",7)(41,"label",23),s(42,"Nouvelle image "),n(43,"span",24),s(44,"*"),i()(),n(45,"input",25),g("change",function(P){return o.onFileChange(P)}),i()()()(),n(46,"div",26),y(47,Be,2,0,"button",27)(48,Oe,2,0,"button",28)(49,Ie,2,0,"button",29),i()()()),e&2&&(a(3),l("formGroup",o.updatebusiness),a(19),l("readonly",!o.isEditing),a(4),l("readonly",!o.isEditing),a(3),l("ngIf",o.typeValue==="physique"),a(),l("ngIf",o.typeValue==="physique"),a(4),l("readonly",!o.isEditing),a(5),l("src",o.bu_picture,w),a(8),l("ngIf",!o.isEditing),a(),l("ngIf",o.isEditing),a(),l("ngIf",o.isEditing))},dependencies:[f,_,M,I,z,L,$,j,H,U,A,G,J],styles:["input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{color:#000!important}label[_ngcontent-%COMP%]{color:#444;font-weight:500}.card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-outline-dark[_ngcontent-%COMP%]:hover{background-color:#333;color:#fff}.cancel-btn[_ngcontent-%COMP%]{background:#ff0019!important;color:#fff}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:.3s;background:linear-gradient(to right,#a37b04,#dda706);color:#fff}.btn[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#2c5364)}.save-btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:15px}"]})};var Pe=[{path:"",component:Q,children:[{path:"",redirectTo:"create-business",pathMatch:"full"},{path:"create-business",component:Y},{path:"readall-business",component:Z},{path:"readsingle-business/:bu_uid",component:ee},{path:"update-business/:bu_uid",component:ne},{path:"delete-business/:bu_uid",component:te}]}],ie=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=D({type:r});static \u0275inj=F({imports:[f.forChild(Pe),f]})};var pe=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=D({type:r});static \u0275inj=F({imports:[_,ie]})};export{pe as BusinessModule};
