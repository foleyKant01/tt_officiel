import{a as L}from"./chunk-BSYTQXDF.js";import{a as ge}from"./chunk-5FXP5EYW.js";import{a as D,b as C,c as V,d as j,e as A,f as m,g as U,h as q,i as z,j as G,k as J,l as H,n as le,o as ue,p as O,q as de}from"./chunk-MC74N3Z2.js";import{$ as w,A as c,E as h,G as u,I as n,J as i,K as d,L as k,M as g,N as v,O as s,P as p,Q as x,S as E,_ as F,aa as _,ba as re,d as be,ea as B,fa as ae,ga as M,ja as f,k as ie,l as R,n as se,p as b,q as T,t as I,u as P,y as oe,z as a}from"./chunk-5VA7YNX3.js";var $=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=b({type:r,selectors:[["app-business"]],standalone:!0,features:[E],decls:1,vars:0,template:function(e,o){e&1&&d(0,"router-outlet")},dependencies:[f,ae,ue,_]})};var ne=be(ge());var y=class r{constructor(t){this.http=t}api_url=de.apiUrl;CreateBusiness(t){return this.http.post(this.api_url+"/api/business/createbusiness",t)}UpdateBusiness(t){return this.http.post(this.api_url+"/api/business/updatebusiness",t)}ReadAllBusinessByTeller(t){return this.http.post(this.api_url+"/api/business/readallbusinessbyteller",t)}ReadSingleBusiness(t){return this.http.post(this.api_url+"/api/business/readsinglebusiness",t)}ReadAllBusinessByCategories(t){return this.http.post(this.api_url+"/api/business/readsinglebusinessbycategories",t)}DeleteBusiness(t){return this.http.post(this.api_url+"/api/business/deletebusiness",t)}static \u0275fac=function(e){return new(e||r)(se(re))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})};function _e(r,t){if(r&1&&(n(0,"option",28),s(1),i()),r&2){let e=t.$implicit;u("value",e),a(),p(e)}}function ye(r,t){r&1&&(n(0,"div",29)(1,"small"),s(2,"Pour une g\xE9olocalisation pr\xE9cise, veuillez \xEAtre pr\xE9sent sur le site de l\u2019entit\xE9 au moment de sa cr\xE9ation."),i()())}function ve(r,t){r&1&&(n(0,"div",6)(1,"label",30),s(2,"Ville "),n(3,"span",8),s(4,"*"),i()(),d(5,"input",31),i())}function Ce(r,t){r&1&&(n(0,"div",6)(1,"label",32),s(2,"Adresse "),n(3,"span",8),s(4,"*"),i()(),d(5,"input",33),i())}function xe(r,t){r&1&&(n(0,"div",6)(1,"label",34),s(2,"Site Web "),n(3,"span",8),s(4,"*"),i()(),d(5,"input",35),i())}var Q=class r{constructor(t,e,o,l){this.router=t;this.fb=e;this.http=o;this.api=l}data=[];latitude;longitude;error;allBusiness=[];business;loading=!1;delayDuration=2e3;success=!1;teller_infos;t_uid;file;localisation;coordonne;city;address;allCategories=[];ngOnInit(){this.loadCategories();let t=sessionStorage.getItem("teller_infos"),e=JSON.parse(sessionStorage.getItem("coordonne")||"null");e&&(this.coordonne=e),this.teller_infos=t,t&&(this.teller_infos=JSON.parse(t),this.t_uid=this.teller_infos.t_uid,this.createbusiness.patchValue({t_uid:this.t_uid}));let o=JSON.parse(sessionStorage.getItem("localisation")||"null");if(o){this.localisation=o;let l=this.localisation.infos_maps;this.city=[l.state,l.city].filter(Boolean).join(", "),this.address=[l.suburb,l.neighbourhood,l.road].filter(Boolean).join(", ")}this.createbusiness.get("type")?.valueChanges.subscribe(l=>{l==="physique"?this.createbusiness.patchValue({city:this.city,address:this.address,latitude:this.coordonne.latitude,longitude:this.coordonne.longitude}):this.createbusiness.patchValue({city:"",address:"",latitude:"",longitude:""})})}get typeValue(){return this.createbusiness.get("type")?.value}loadCategories(){this.api.ReadAllCategories()?.subscribe({next:t=>{this.data=t?.categorie_name,this.allCategories=this.data.map(e=>e?.name),console.log(this.allCategories)}})}createbusiness=new A({categorie:new m(null,C.required),type:new m(null,C.required),name:new m(null,C.required),description:new m(null,C.required),city:new m(null),address:new m(null),website:new m(null),phone:new m(null,C.required),t_uid:new m(null,C.required),latitude:new m(null,C.required),longitude:new m(null,C.required)});onFileChange(t){console.log(t);let e=t.target.files[0];return this.file=e,console.log(this.file),e}Createbusiness(){if(this.createbusiness.valid){this.loading=!0;let t=new FormData;t.append("categorie",this.createbusiness.get("categorie")?.value),t.append("type",this.createbusiness.get("type")?.value),t.append("name",this.createbusiness.get("name")?.value),t.append("description",this.createbusiness.get("description")?.value),t.append("city",this.createbusiness.get("city")?.value),t.append("address",this.createbusiness.get("address")?.value),t.append("website",this.createbusiness.get("website")?.value),t.append("phone",this.createbusiness.get("phone")?.value),t.append("t_uid",this.createbusiness.get("t_uid")?.value),t.append("latitude",this.createbusiness.get("latitude")?.value),t.append("longitude",this.createbusiness.get("longitude")?.value),this.http.CreateBusiness(t).subscribe({next:e=>{console.log(e),e?.status==="success"?(this.data=e,ne.default.fire({title:"Succ\xE8s !",text:"L'entit\xE9 a \xE9t\xE9 cr\xE9\xE9e avec succ\xE8s !",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#dda706"}).then(()=>{window.location.reload()})):ne.default.fire({title:"Erreur !",text:e?.error_description||"\xC9chec de cr\xE9ation.",icon:"error",confirmButtonText:"R\xE9essayer",confirmButtonColor:"#ff6c2f"})},error:e=>{console.error(e),setTimeout(()=>{this.loading=!1},this.delayDuration)}})}}navigateToRead(){this.router.navigate(["/teller/business/readall-business"])}GetLocalisation(){}static \u0275fac=function(e){return new(e||r)(c(M),c(le),c(y),c(L))};static \u0275cmp=b({type:r,selectors:[["app-create-business"]],standalone:!0,features:[E],decls:56,vars:7,consts:[[1,"container","my-5","p-5","shadow","bg-white","rounded"],[1,"text-center","mb-4","fw-bold","text-dark"],["enctype","multipart/form-data",1,"row","g-4",3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"card","p-3","border-0","shadow-sm"],[1,"text-primary"],[1,"form-group","mt-2"],["for","categorie"],[1,"text-danger"],["formControlName","categorie",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["for","type"],["formControlName","type",1,"form-select"],["value","physique"],["value","en-ligne"],["for","name"],["type","text","formControlName","name","id","name",1,"form-control"],["for","description"],["formControlName","description","id","description","rows","3",1,"form-control"],[1,"form-check","mt-3"],["type","checkbox","id","terms",1,"form-check-input"],["for","terms",1,"form-check-label"],["class","form-check p-0 alert alert-warning text-dark mt-3","role","alert",4,"ngIf"],["class","form-group mt-2",4,"ngIf"],["for","phone"],["type","text","formControlName","phone","id","phone",1,"form-control"],[1,"col-12","text-center","mt-4"],["type","submit",1,"btn","btn-warning","px-5","py-2","rounded-pill","shadow",3,"disabled"],[3,"value"],["role","alert",1,"form-check","p-0","alert","alert-warning","text-dark","mt-3"],["for","city"],["type","text","formControlName","city","id","city",1,"form-control"],["for","address"],["type","text","formControlName","address","id","address",1,"form-control"],["for","website"],["type","text","formControlName","website","id","website",1,"form-control"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1),s(2,"Cr\xE9er une Entit\xE9"),i(),n(3,"form",2),g("ngSubmit",function(){return o.Createbusiness()}),n(4,"div",3)(5,"div",4)(6,"h5",5),s(7,"Informations G\xE9n\xE9rales"),i(),n(8,"div",6)(9,"label",7),s(10,"Cat\xE9gorie "),n(11,"span",8),s(12,"*"),i()(),n(13,"select",9),h(14,_e,2,2,"option",10),i()(),n(15,"div",6)(16,"label",11),s(17,"Type "),n(18,"span",8),s(19,"*"),i()(),n(20,"select",12)(21,"option",13),s(22,"Physique"),i(),n(23,"option",14),s(24,"En ligne"),i()()(),n(25,"div",6)(26,"label",15),s(27,"Nom de l'entit\xE9 "),n(28,"span",8),s(29,"*"),i()(),d(30,"input",16),i(),n(31,"div",6)(32,"label",17),s(33,"Description "),n(34,"span",8),s(35,"*"),i()(),d(36,"textarea",18),i(),n(37,"div",19),d(38,"input",20),n(39,"label",21),s(40," J'accepte les conditions g\xE9n\xE9rales d'utilisation "),i()()()(),n(41,"div",3)(42,"div",4),h(43,ye,3,0,"div",22)(44,ve,6,0,"div",23)(45,Ce,6,0,"div",23),n(46,"div",6)(47,"label",24),s(48,"T\xE9l\xE9phone "),n(49,"span",8),s(50,"*"),i()(),d(51,"input",25),i(),h(52,xe,6,0,"div",23),i()(),n(53,"div",26)(54,"button",27),s(55,"Cr\xE9er l'entit\xE9"),i()()()()),e&2&&(a(3),u("formGroup",o.createbusiness),a(11),u("ngForOf",o.allCategories),a(29),u("ngIf",o.typeValue==="physique"),a(),u("ngIf",o.typeValue==="physique"),a(),u("ngIf",o.typeValue==="physique"),a(7),u("ngIf",o.typeValue==="en-ligne"),a(2),u("disabled",o.createbusiness.invalid))},dependencies:[f,_,F,w,O,U,J,H,D,G,V,j,q,z],styles:["input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{color:#000!important}label[_ngcontent-%COMP%]{color:#444;font-weight:500}.card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-outline-dark[_ngcontent-%COMP%]:hover{background-color:#333;color:#fff}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:1rem!important}.card[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding:1.25rem!important}h2[_ngcontent-%COMP%]{font-size:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.95rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:.95rem;padding:.55rem .75rem}.btn-warning[_ngcontent-%COMP%]{font-size:.95rem;padding:.5rem 2rem}.btn-warning.rounded-pill[_ngcontent-%COMP%]{border-radius:25px!important}.form-check[_ngcontent-%COMP%]{font-size:.9rem}.alert[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.85rem}}@media (max-width: 576px){.container[_ngcontent-%COMP%]{margin:1rem auto}.btn-warning[_ngcontent-%COMP%]{width:100%}.text-center.mt-4[_ngcontent-%COMP%]{margin-top:2rem!important}}"]})};function Ee(r,t){if(r&1){let e=k();n(0,"tr")(1,"td",13),s(2),i(),n(3,"td",14),s(4),i(),n(5,"td"),s(6),i(),n(7,"td"),s(8),i(),n(9,"td"),s(10),i(),n(11,"td"),s(12),i(),n(13,"td",11)(14,"button",15),g("click",function(){let l=I(e).$implicit,pe=v(2);return P(pe.Readsinglebusiness(l.bu_uid))}),d(15,"i",16),i()()()}if(r&2){let e=t.$implicit,o=t.index;a(2),p(o+1),a(2),p(e==null?null:e.bu_name),a(2),p(e==null?null:e.bu_categorie),a(2),p(e==null?null:e.bu_type),a(2),p(e==null?null:e.bu_city),a(2),p(e==null?null:e.bu_website)}}function Se(r,t){if(r&1&&(n(0,"table",9)(1,"thead",10)(2,"tr")(3,"th"),s(4,"#"),i(),n(5,"th"),s(6,"Nom"),i(),n(7,"th"),s(8,"Cat\xE9gorie"),i(),n(9,"th"),s(10,"Type"),i(),n(11,"th"),s(12,"Ville"),i(),n(13,"th"),s(14,"Site Web"),i(),n(15,"th",11),s(16,"Action"),i()()(),n(17,"tbody"),h(18,Ee,16,6,"tr",12),i()()),r&2){let e=v();a(18),u("ngForOf",e.dataBusiness)}}function we(r,t){r&1&&(n(0,"div",17),d(1,"i",18),n(2,"p",19),s(3,"Aucune entit\xE9 disponible pour le moment."),i()())}var X=class r{constructor(t,e,o,l){this.route=t;this.router=e;this.http=o;this.api=l}allBusiness;teller_infos;t_uid;dataBusiness;ngOnInit(){let t=sessionStorage.getItem("teller_infos");this.teller_infos=t,t&&(this.teller_infos=JSON.parse(t),this.t_uid=this.teller_infos.t_uid),console.log("t_uid: ",this.t_uid),this.Readallbusinessbyteller()}Readallbusinessbyteller(){let t={t_uid:this.t_uid};this.http.ReadAllBusinessByTeller(t).subscribe({next:e=>{this.allBusiness=e,e?.business&&(this.dataBusiness=e?.business,console.log(this.dataBusiness))}})}Readsinglebusiness(t){this.router.navigate(["/teller/business/readsingle-business",t])}static \u0275fac=function(e){return new(e||r)(c(B),c(M),c(y),c(L))};static \u0275cmp=b({type:r,selectors:[["app-readall-business"]],standalone:!0,features:[E],decls:11,vars:3,consts:[[1,"container","mt-5"],[1,"card","shadow-sm","border-0","rounded-4","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"fw-bold","text-dark","m-0"],[1,"bi","bi-building","me-2","text-primary"],[1,"badge","bg-warning","text-dark","fs-6","px-3","py-2","rounded-pill","shadow-sm"],[1,"table-responsive"],["class","table table-hover align-middle",4,"ngIf"],["class","text-center py-5 text-muted",4,"ngIf"],[1,"table","table-hover","align-middle"],[1,"table-light","text-dark"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"fw-semibold"],[1,"fw-semibold","text-dark"],["title","Voir les d\xE9tails",1,"btn","show","btn-sm","btn-outline-primary","rounded-circle","shadow-sm",3,"click"],[1,"bi","bi-eye-fill"],[1,"text-center","py-5","text-muted"],[1,"bi","bi-info-circle","fs-2","mb-2"],[1,"m-0"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),d(4,"i",4),s(5," Mes Entit\xE9s "),i(),n(6,"span",5),s(7),i()(),n(8,"div",6),h(9,Se,19,1,"table",7)(10,we,4,0,"div",8),i()()()),e&2&&(a(7),x(" Total : ",(o.dataBusiness==null?null:o.dataBusiness.length)||0," "),a(2),u("ngIf",o.dataBusiness&&o.dataBusiness.length>0),a(),u("ngIf",o.dataBusiness.length===0))},dependencies:[f,_,F,w,O],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.badge[_ngcontent-%COMP%]{font-size:1rem}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#0d6efd;color:#fff;border-color:#0d6efd}.show[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:0px;color:#fff;transition:background .3s ease}.show[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}@media (max-width: 768px){.card.p-4[_ngcontent-%COMP%]{padding:1.2rem!important}h4.fw-bold[_ngcontent-%COMP%]{font-size:1.25rem;text-align:center}.badge.fs-6[_ngcontent-%COMP%]{font-size:.875rem!important;padding:.3rem .6rem!important;display:block;margin:0 auto;text-align:center}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;align-items:center!important;gap:.75rem}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1.2rem;border:1px solid #dee2e6;border-radius:.5rem;padding:.75rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.4rem 0;font-size:.875rem;border:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:600;color:#555;flex-basis:50%;text-align:left}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;width:30px}}@media (max-width: 576px){.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem}.btn.show[_ngcontent-%COMP%]{width:30px;height:30px;padding:0;font-size:.75rem}}']})};var Y=class r{constructor(t,e,o){this.route=t;this.router=e;this.http=o}bu_uid;ville;adresse;bu_website;all_business;ngOnInit(){this.route.params.subscribe(t=>{this.bu_uid=t.bu_uid,console.log("bu_uid re\xE7u:",this.bu_uid);let e=performance.getEntriesByType("navigation");e.length&&e[0].type==="reload"&&(sessionStorage.removeItem("single_business"),console.log("Page recharg\xE9e \u2192 single_business supprim\xE9")),this.readSingleBusiness()})}goBack(){sessionStorage.removeItem("single_business"),this.router.navigate(["/teller/business/readall-business"])}goToUpdate(){this.router.navigate(["/teller/business/update-business",this.all_business.bu_uid])}readSingleBusiness(){let t={bu_uid:this.bu_uid};console.log("Envoi au backend:",t),this.http.ReadSingleBusiness(t).subscribe({next:e=>{console.log("R\xE9ponse backend:",e),e?.status==="success"?(this.all_business=e.business,sessionStorage.setItem("single_business",JSON.stringify(e.business)),console.log("Business re\xE7u:",this.all_business),this.all_business.bu_type==="physique"&&(this.all_business=e.business,this.ville="Ville :",this.adresse="Adresse :",this.bu_website="Site web :")):console.warn("R\xE9ponse sans succ\xE8s")},error:e=>{console.error("Erreur API:",e)}})}static \u0275fac=function(e){return new(e||r)(c(B),c(M),c(y))};static \u0275cmp=b({type:r,selectors:[["app-readsingle-business"]],decls:44,vars:12,consts:[[1,"container","my-5","p-4","shadow","bg-white","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-md-8"],[1,"fw-bold","text-dark","mb-2"],[1,"badge","bg-primary"],[1,"badge","bg-secondary","ms-2","text-capitalize"],[1,"col-md-4","text-end"],[1,"btn","btn-outline-secondary","rounded-pill","me-2",3,"click"],[1,"bi","bi-arrow-left-circle","me-1"],[1,"btn","btn-warning","rounded-pill","shadow-sm",3,"click"],[1,"bi","bi-pencil-square","me-1"],[1,"row","g-4"],[1,"col-md-12"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"bi","bi-building","text-secondary","me-1"],[1,"bi","bi-geo-alt-fill","text-secondary","me-1"],[1,"bi","bi-globe2","text-secondary","me-1"],["target","_blank","rel","noopener noreferrer",3,"href"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),s(4),i(),n(5,"span",4),s(6),i(),n(7,"span",5),s(8),i()(),n(9,"div",6)(10,"button",7),g("click",function(){return o.goBack()}),d(11,"i",8),s(12," Retour "),i(),n(13,"button",9),g("click",function(){return o.goToUpdate()}),d(14,"i",10),s(15," Mettre \xE0 jour "),i()()(),n(16,"div",11)(17,"div",12)(18,"ul",13)(19,"li",14)(20,"strong"),s(21,"Description :"),i(),d(22,"br"),s(23),i(),n(24,"li",14)(25,"strong"),s(26,"T\xE9l\xE9phone :"),i(),s(27),i(),n(28,"li",14),d(29,"i",15),n(30,"strong"),s(31),i(),s(32),i(),n(33,"li",14),d(34,"i",16),n(35,"strong"),s(36),i(),s(37),i(),n(38,"li",14),d(39,"i",17),n(40,"strong"),s(41),i(),n(42,"a",18),s(43),i()()()()()()),e&2&&(a(4),p(o.all_business.bu_name),a(2),p(o.all_business.bu_categorie),a(2),p(o.all_business.bu_type),a(15),x(" ",o.all_business.bu_description," "),a(4),x(" ",o.all_business.phone," "),a(4),p(o.ville),a(),x(" ",o.all_business.bu_city," "),a(4),p(o.adresse),a(),x(" ",o.all_business.bu_address," "),a(4),p(o.bu_website),a(),u("href",o.all_business.bu_website,oe),a(),x(" ",o.all_business.bu_website," "))},styles:[".list-group-item[_ngcontent-%COMP%]{background-color:transparent;border:none;padding-left:0;padding-right:0}img.img-fluid[_ngcontent-%COMP%]{max-height:300px;object-fit:cover}.goBack[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);color:#fff;border:0px}.goBack[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff;transition:.3s ease}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679);color:#fff}"]})};var Z=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=b({type:r,selectors:[["app-delete-business"]],decls:2,vars:0,template:function(e,o){e&1&&(n(0,"p"),s(1,"delete-business works!"),i())}})};function Be(r,t){if(r&1&&(n(0,"div",7)(1,"label",24),s(2,"Ville"),i(),d(3,"input",25),i()),r&2){let e=v();a(3),u("readonly",!e.isEditing)}}function Me(r,t){if(r&1&&(n(0,"div",7)(1,"label",26),s(2,"Adresse"),i(),d(3,"input",27),i()),r&2){let e=v();a(3),u("readonly",!e.isEditing)}}function Oe(r,t){if(r&1&&(n(0,"div",7)(1,"label",28),s(2,"Site web"),i(),d(3,"input",29),i()),r&2){let e=v();a(3),u("readonly",!e.isEditing)}}function Ie(r,t){if(r&1){let e=k();n(0,"button",30),g("click",function(){I(e);let l=v();return P(l.isEditing=!0)}),s(1,"Modifier"),i()}}function Pe(r,t){r&1&&(n(0,"button",31),s(1,"Enregistrer"),i())}function ke(r,t){if(r&1){let e=k();n(0,"button",32),g("click",function(){I(e);let l=v();return P(l.cancelEdit())}),s(1,"Annuler"),i()}}var ee=class r{constructor(t,e){this.http=t;this.route=e}updatebusiness;all_business;allCategories=[];data;businessId;loading=!1;isEditing=!1;localisation;coordonne;city;file;type;single_business;selectedFile=null;bu_picture="";address;latitude;longitude;ngOnInit(){let t=JSON.parse(sessionStorage.getItem("single_business")||"{}");this.single_business=t,this.type=this.single_business.bu_type,console.log("single_business:",this.single_business),this.updatebusiness=new A({bu_uid:new m(t.bu_uid||""),bu_type:new m(t.bu_type||""),bu_name:new m(t.bu_name||""),bu_description:new m(t.bu_description||""),bu_city:new m(t.bu_city||""),phone:new m(t.phone||""),bu_address:new m(t.bu_address||""),bu_website:new m(t.bu_website||""),latitude:new m(t.latitude||""),longitude:new m(t.longitude||"")});let e=JSON.parse(sessionStorage.getItem("localisation")||"null"),o=JSON.parse(sessionStorage.getItem("coordonne")||"null");if(e){this.localisation=e;let l=this.localisation.infos_maps;this.city=[l.state,l.city].filter(Boolean).join(", "),this.address=[l.suburb,l.neighbourhood,l.road].filter(Boolean).join(", ")}o&&(this.coordonne=o,this.latitude=this.coordonne.latitude,this.longitude=this.coordonne.longitude),this.updatebusiness.patchValue({latitude:this.latitude,longitude:this.longitude}),this.updatebusiness.get("bu_type")?.valueChanges.subscribe(l=>{l==="physique"?this.updatebusiness.patchValue({bu_city:this.city,bu_address:this.address}):this.updatebusiness.patchValue({bu_city:"",bu_address:""})})}get typeValue(){return this.updatebusiness.get("bu_type")?.value}onFileChange(t){let e=t.target.files[0];if(e){this.selectedFile=e;let o=URL.createObjectURL(e);this.bu_picture=o}}updateBusiness(){if(this.updatebusiness.valid){this.loading=!0;let t=new FormData;t.append("bu_uid",this.updatebusiness.get("bu_uid")?.value),t.append("bu_type",this.updatebusiness.get("bu_type")?.value),t.append("bu_name",this.updatebusiness.get("bu_name")?.value),t.append("bu_description",this.updatebusiness.get("bu_description")?.value),t.append("bu_city",this.updatebusiness.get("bu_city")?.value),t.append("phone",this.updatebusiness.get("phone")?.value),t.append("bu_address",this.updatebusiness.get("bu_address")?.value),t.append("latitude",this.updatebusiness.get("latitude")?.value),t.append("longitude",this.updatebusiness.get("longitude")?.value),this.http.UpdateBusiness(t).subscribe({next:e=>{if(console.log("Response:",e),e?.status==="success"){let o=this.updatebusiness.value;console.log("Updated Business:",o),sessionStorage.setItem("single_business",JSON.stringify(e.business)),this.isEditing=!1,this.data=e,e.business?this.showSuccessToast("Mise \xE0 jour r\xE9ussie"):this.showErrorToast("Erreur : donn\xE9es incompl\xE8tes")}else this.showErrorToast("\xC9chec de la mise \xE0 jour. Veuillez r\xE9essayer.")},error:e=>{console.error("Erreur :",e),this.showErrorToast("Une erreur est survenue. Veuillez r\xE9essayer.")},complete:()=>{this.loading=!1}})}}cancelEdit(){this.isEditing=!1,this.ngOnInit()}showSuccessToast(t){let e=document.getElementById("successToastBody");e?e.textContent=t:console.warn("Success toast body element not found.");let o=document.getElementById("successToast");new bootstrap.Toast(o,{delay:2e3}).show()}showErrorToast(t){let e=document.getElementById("errorToastBody");e?e.textContent=t:console.warn("Error toast body element not found.");let o=document.getElementById("errorToast");new bootstrap.Toast(o,{delay:2e3}).show()}static \u0275fac=function(e){return new(e||r)(c(y),c(B))};static \u0275cmp=b({type:r,selectors:[["app-update-business"]],standalone:!0,features:[E],decls:40,vars:10,consts:[[1,"container","my-5","p-5","shadow","bg-white","rounded"],[1,"text-center","mb-4","fw-bold","text-dark"],["enctype","multipart/form-data",1,"row","g-4",3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"card","p-3","border-0","shadow-sm"],[1,"text-primary"],["role","alert",1,"form-check","p-0","alert","alert-warning","text-dark"],[1,"form-group","mt-2"],["for","type"],["formControlName","bu_type",1,"form-select"],["value","physique"],["value","en-ligne"],["for","bu_name"],["type","text","formControlName","bu_name","id","bu_name",1,"form-control",3,"readonly"],["for","bu_description"],["formControlName","bu_description","id","bu_description","rows","3",1,"form-control",3,"readonly"],["class","form-group mt-2",4,"ngIf"],[1,"form-group","mt-4"],["for","phone"],["type","text","formControlName","phone","id","phone",1,"form-control",3,"readonly"],[1,"col-12","text-center","mt-4","button-group"],["type","button","class","btn edit-btn",3,"click",4,"ngIf"],["type","submit","class","btn save-btn",4,"ngIf"],["type","button","class","btn cancel-btn",3,"click",4,"ngIf"],["for","bu_city"],["type","text","formControlName","bu_city","id","bu_city",1,"form-control",3,"readonly"],["for","bu_address"],["type","text","formControlName","bu_address","id","bu_address",1,"form-control",3,"readonly"],["for","bu_website"],["type","text","formControlName","bu_website","id","bu_website",1,"form-control",3,"readonly"],["type","button",1,"btn","edit-btn",3,"click"],["type","submit",1,"btn","save-btn"],["type","button",1,"btn","cancel-btn",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1),s(2,"Mettre \xE0 Jour l\u2019Entit\xE9"),i(),n(3,"form",2),g("ngSubmit",function(){return o.updateBusiness()}),n(4,"div",3)(5,"div",4)(6,"h5",5),s(7,"Informations G\xE9n\xE9rales"),i(),n(8,"div",6)(9,"small"),s(10,"Pour une g\xE9olocalisation pr\xE9cise, veuillez \xEAtre pr\xE9sent sur le site de l\u2019entit\xE9."),i()(),n(11,"div",7)(12,"label",8),s(13,"Type"),i(),n(14,"select",9)(15,"option",10),s(16,"Physique"),i(),n(17,"option",11),s(18,"En ligne"),i()()(),n(19,"div",7)(20,"label",12),s(21,"Nom de l'entit\xE9"),i(),d(22,"input",13),i(),n(23,"div",7)(24,"label",14),s(25,"Description"),i(),d(26,"textarea",15),i()()(),n(27,"div",3)(28,"div",4),h(29,Be,4,1,"div",16)(30,Me,4,1,"div",16)(31,Oe,4,1,"div",16),n(32,"div",17)(33,"label",18),s(34,"T\xE9l\xE9phone"),i(),d(35,"input",19),i()()(),n(36,"div",20),h(37,Ie,2,0,"button",21)(38,Pe,2,0,"button",22)(39,ke,2,0,"button",23),i()()()),e&2&&(a(3),u("formGroup",o.updatebusiness),a(19),u("readonly",!o.isEditing),a(4),u("readonly",!o.isEditing),a(3),u("ngIf",o.typeValue==="physique"),a(),u("ngIf",o.typeValue==="physique"),a(),u("ngIf",o.typeValue!=="physique"),a(4),u("readonly",!o.isEditing),a(2),u("ngIf",!o.isEditing),a(),u("ngIf",o.isEditing),a(),u("ngIf",o.isEditing))},dependencies:[f,_,w,O,U,J,H,D,G,V,j,q,z],styles:["input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{color:#000!important}label[_ngcontent-%COMP%]{color:#444;font-weight:500}.card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(to right,#a37b04,#dda706);border:none;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#396679)}.btn-outline-dark[_ngcontent-%COMP%]:hover{background-color:#333;color:#fff}.cancel-btn[_ngcontent-%COMP%]{background:#ff0019!important;color:#fff}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:.3s;background:linear-gradient(to right,#a37b04,#dda706);color:#fff}.btn[_ngcontent-%COMP%]:hover{background:linear-gradient(to right,#203a43,#2c5364)}.save-btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:15px}"]})};var Ne=[{path:"",component:$,children:[{path:"",redirectTo:"create-business",pathMatch:"full"},{path:"create-business",component:Q},{path:"readall-business",component:X},{path:"readsingle-business/:bu_uid",component:Y},{path:"update-business/:bu_uid",component:ee},{path:"delete-business/:bu_uid",component:Z}]}],te=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=T({type:r});static \u0275inj=R({imports:[f.forChild(Ne),f]})};var ce=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=T({type:r});static \u0275inj=R({imports:[_,te]})};export{ce as BusinessModule};
